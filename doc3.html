<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>KETADATA // DOC</title>
<style>
  :root{
    /* THEME (user-adjustable) */
    --appBg: #000000;          /* outside area */
    --docBg: #0a0a0a;          /* page background */
    --text:  #ffffff;          /* page text */
    --muted: rgba(255,255,255,.55);
    --hair:  rgba(255,255,255,.14);
    --hair2: rgba(255,255,255,.08);
    --shadow: rgba(0,0,0,.65);

    /* PAGE */
    --pageW: min(920px, 92vw);
    --pagePad: 56px;
    --fontSize: 18px;
    --lineHeight: 1.55;

    /* UI */
    --topH: 44px;
    --btnBg: rgba(0,0,0,.20);
    --btnBg2: rgba(0,0,0,.34);
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    background: var(--appBg);
    color: var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    overflow:hidden;
  }

  /* =========================================================
     TOP BAR (BOLD, INTUITIVE)
  ========================================================= */
  #top{
    position:fixed; left:0; right:0; top:0; height:var(--topH);
    z-index:50;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 12px;
    border-bottom:1px solid var(--hair);
    background: rgba(0,0,0,.34);
    backdrop-filter: blur(10px);
    user-select:none;
  }
  #brand{
    display:flex; align-items:center; gap:10px;
    min-width:0;
  }
  #brand .sq{
    width:12px; height:12px;
    border:1px solid #fff;
    background:#fff;
    flex:0 0 auto;
  }
  #brand .t{
    font-size:11px;
    letter-spacing:.22em;
    text-transform:uppercase;
    color: rgba(255,255,255,.84);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    max-width: 54vw;
    font-weight:900;
  }

  #actions{
    display:flex;
    align-items:center;
    gap:8px;
  }

  .btn{
    height:28px;
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding: 0 10px;
    border:1px solid var(--hair);
    background: var(--btnBg);
    color: rgba(255,255,255,.82);
    font-size:11px;
    letter-spacing:.18em;
    text-transform:uppercase;
    cursor:pointer;
    line-height:1;
    user-select:none;
  }
  .btn:hover{
    color:#fff;
    border-color: rgba(255,255,255,.30);
    background: var(--btnBg2);
  }
  .btn:active{ transform: translateY(1px); }

  .pill{
    height:28px;
    border:1px solid var(--hair);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.72);
    display:flex;
    align-items:center;
    padding: 0 10px;
    font-size:11px;
    letter-spacing:.16em;
    text-transform:uppercase;
    gap:10px;
    user-select:none;
  }
  .pill b{ color:#fff; font-weight:900; }

  /* =========================================================
     LAYOUT
  ========================================================= */
  #wrap{
    position:fixed; inset:0;
    padding-top: var(--topH);
    display:grid;
    grid-template-columns: 320px 1fr;
  }

  /* LEFT PANEL (THEME + DOC CONTROLS) */
  #panel{
    border-right: 1px solid var(--hair2);
    background: rgba(0,0,0,.22);
    backdrop-filter: blur(10px);
    overflow:auto;
  }
  #panelInner{
    padding: 14px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .card{
    border:1px solid var(--hair);
    background: rgba(0,0,0,.18);
    padding: 12px;
  }
  .card .h{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:10px;
  }
  .card .h .lab{
    font-size:11px;
    letter-spacing:.22em;
    text-transform:uppercase;
    font-weight:900;
    color: rgba(255,255,255,.84);
  }
  .hint{
    font-size:11px;
    letter-spacing:.10em;
    color: rgba(255,255,255,.52);
    line-height:1.35;
  }

  .row{
    display:grid;
    grid-template-columns: 1fr 120px;
    gap:10px;
    align-items:center;
    margin-top:10px;
  }
  .row label{
    font-size:10px;
    letter-spacing:.22em;
    text-transform:uppercase;
    color: rgba(255,255,255,.70);
  }
  input[type="color"]{
    width:100%;
    height:34px;
    border:1px solid var(--hair);
    background: transparent;
    padding: 0;
    cursor:pointer;
  }
  .mini{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    margin-top:10px;
  }
  .sw{
    width:28px;height:28px;
    border:1px solid var(--hair);
    cursor:pointer;
    background:#fff;
  }

  .rangeRow{
    display:flex;
    align-items:center;
    gap:10px;
    margin-top:10px;
  }
  .rangeRow label{
    flex:1;
    font-size:10px;
    letter-spacing:.22em;
    text-transform:uppercase;
    color: rgba(255,255,255,.70);
  }
  .rangeRow input[type="range"]{
    flex:1.2;
    accent-color: #fff;
  }
  .val{
    width:52px;
    text-align:right;
    font-size:11px;
    letter-spacing:.16em;
    color:#fff;
    font-weight:900;
  }

  /* MAIN DOC AREA */
  #main{
    overflow:auto;
    background: linear-gradient(180deg, rgba(255,255,255,.02), transparent 140px);
  }

  #page{
    width: var(--pageW);
    margin: 26px auto 60px auto;
    background: var(--docBg);
    color: var(--text);
    border:1px solid var(--hair);
    box-shadow: 0 24px 90px var(--shadow);
    border-radius: 10px;
  }

  #pageTop{
    border-bottom:1px solid var(--hair2);
    padding: 14px 18px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    user-select:none;
  }

  #docTitle{
    font-weight:900;
    letter-spacing:.06em;
    text-transform: uppercase;
    font-size: 12px;
    color: rgba(255,255,255,.86);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    max-width: 62%;
  }

  #status{
    font-size:10px;
    letter-spacing:.20em;
    text-transform:uppercase;
    color: rgba(255,255,255,.55);
    white-space:nowrap;
  }

  #editor{
    padding: var(--pagePad);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    font-size: var(--fontSize);
    line-height: var(--lineHeight);
    outline:none;
    min-height: 68vh;
    white-space: pre-wrap;
  }

  /* simple bold selection feel */
  #editor b, #editor strong{
    font-weight: 900;
  }

  /* subtle caret visibility in dark */
  #editor:focus{
    caret-color: #fff;
  }

  /* tooltips / focus rings minimal */
  .btn:focus-visible, input:focus-visible{
    outline: 2px solid rgba(255,255,255,.22);
    outline-offset: 2px;
  }

  /* responsive */
  @media (max-width: 980px){
    #wrap{ grid-template-columns: 1fr; }
    #panel{ border-right:0; border-bottom:1px solid var(--hair2); }
    #page{ width: min(940px, 94vw); }
  }
</style>
</head>

<body>
  <div id="top">
    <div id="brand">
      <div class="sq" aria-hidden="true"></div>
      <div class="t">KETADATA // DOC (GOOGLE-DOC TYPE)</div>
    </div>

    <div id="actions">
      <div class="pill"><span>STATE:</span> <b id="saveState">UNSAVED</b></div>
      <button class="btn" id="btnSave">SAVE</button>
      <button class="btn" id="btnExport">EXPORT</button>
      <button class="btn" id="btnImport">IMPORT</button>
      <button class="btn" id="btnClear">CLEAR</button>
    </div>
  </div>

  <div id="wrap">
    <aside id="panel">
      <div id="panelInner">

        <div class="card">
          <div class="h">
            <div class="lab">THEME</div>
            <button class="btn" id="btnReset" style="height:24px;padding:0 8px;">RESET</button>
          </div>
          <div class="hint">
            Adjust <b>APP BG</b>, <b>DOC BG</b>, and <b>TEXT</b>. The page updates instantly.
          </div>

          <div class="row">
            <label for="appBg">APP BG</label>
            <input id="appBg" type="color" value="#000000" />
          </div>

          <div class="row">
            <label for="docBg">DOC BG</label>
            <input id="docBg" type="color" value="#0a0a0a" />
          </div>

          <div class="row">
            <label for="textCol">TEXT</label>
            <input id="textCol" type="color" value="#ffffff" />
          </div>

          <div class="mini" aria-label="Quick swatches">
            <div class="sw" title="Black" data-app="#000000" data-doc="#0a0a0a" data-text="#ffffff" style="background:#000"></div>
            <div class="sw" title="Graphite" data-app="#050505" data-doc="#101010" data-text="#f3f3f3" style="background:#1a1a1a"></div>
            <div class="sw" title="Acid" data-app="#000000" data-doc="#001414" data-text="#eaffff" style="background:#00ffff"></div>
            <div class="sw" title="Infra" data-app="#000000" data-doc="#0a0000" data-text="#fff1f1" style="background:#ff2a2a"></div>
            <div class="sw" title="Paper" data-app="#0b0b0b" data-doc="#f2f2f2" data-text="#0a0a0a" style="background:#f2f2f2"></div>
          </div>
        </div>

        <div class="card">
          <div class="h">
            <div class="lab">DOC</div>
            <div class="hint" id="wordCount">0 WORDS</div>
          </div>

          <div class="rangeRow">
            <label for="fontSize">FONT SIZE</label>
            <input id="fontSize" type="range" min="12" max="28" value="18" />
            <div class="val" id="fontVal">18</div>
          </div>

          <div class="rangeRow">
            <label for="padSize">PAGE PADDING</label>
            <input id="padSize" type="range" min="28" max="92" value="56" />
            <div class="val" id="padVal">56</div>
          </div>

          <div class="rangeRow">
            <label for="lineH">LINE HEIGHT</label>
            <input id="lineH" type="range" min="120" max="220" value="155" />
            <div class="val" id="lhVal">1.55</div>
          </div>

          <div class="hint" style="margin-top:10px;">
            Hotkeys: <b>CTRL/CMD+S</b> save · <b>CTRL/CMD+E</b> export · <b>CTRL/CMD+I</b> import
          </div>
        </div>

        <div class="card" id="ioCard" style="display:none;">
          <div class="h">
            <div class="lab">IMPORT / EXPORT</div>
            <button class="btn" id="btnCloseIO" style="height:24px;padding:0 8px;">CLOSE</button>
          </div>
          <textarea id="io" spellcheck="false" style="
            width:100%; height:180px; resize:vertical;
            border:1px solid rgba(255,255,255,.12);
            background: rgba(0,0,0,.40);
            color:#fff;
            padding:10px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Courier New', monospace;
            font-size: 11px;
            letter-spacing:.06em;
            line-height:1.35;
            outline:none;"></textarea>
          <div class="mini" style="margin-top:10px;">
            <button class="btn" id="btnApplyIO">APPLY</button>
            <button class="btn" id="btnCopyIO">COPY</button>
          </div>
        </div>

      </div>
    </aside>

    <main id="main">
      <div id="page" role="document" aria-label="Document">
        <div id="pageTop">
          <div id="docTitle" contenteditable="true" spellcheck="false">UNTITLED DOCUMENT</div>
          <div id="status"><span id="savedAt">—</span></div>
        </div>

        <div id="editor" contenteditable="true" spellcheck="true" aria-label="Editor">
KETADATA DOC

Type like it matters.

- Bold, clean, direct.
- Theme controls on the left.
- Save persists automatically.

        </div>
      </div>
    </main>
  </div>

<script>
/* =========================================================
   KETADATA DOC — BOLD + INTUITIVE + COLOR-ADJUSTABLE
========================================================= */
const FILE_ID = "KETADATA_DOC_V1";
const STATE_KEY = `KETADATA_DOC_STATE::${FILE_ID}`;

const el = (id)=>document.getElementById(id);

const editor   = el("editor");
const titleEl  = el("docTitle");
const saveFlag = el("saveState");
const savedAt  = el("savedAt");
const wordCount= el("wordCount");

const appBg  = el("appBg");
const docBg  = el("docBg");
const textCol= el("textCol");

const fontSize = el("fontSize");
const padSize  = el("padSize");
const lineH    = el("lineH");

const fontVal = el("fontVal");
const padVal  = el("padVal");
const lhVal   = el("lhVal");

const ioCard = el("ioCard");
const ioArea = el("io");

let dirty = false;
let saveT = null;

function setCSSVar(name, value){
  document.documentElement.style.setProperty(name, value);
}

function markDirty(){
  dirty = true;
  saveFlag.textContent = "UNSAVED";
  scheduleAutosave();
  updateCounts();
}

function scheduleAutosave(){
  clearTimeout(saveT);
  saveT = setTimeout(()=>saveState(true), 450);
}

function nowISO(){
  return new Date().toISOString();
}

function updateCounts(){
  const text = editor.innerText.trim();
  const words = text ? text.split(/\s+/).length : 0;
  wordCount.textContent = `${words} WORDS`;
}

function getState(){
  return {
    _ketadata: true,
    file_id: FILE_ID,
    version: "v1",
    updated_at: nowISO(),
    theme: {
      appBg: appBg.value,
      docBg: docBg.value,
      text: textCol.value
    },
    doc: {
      title: titleEl.innerText.trim() || "UNTITLED DOCUMENT",
      html: editor.innerHTML,
      fontSize: Number(fontSize.value),
      pad: Number(padSize.value),
      lineHeight: Number(lineH.value)/100
    }
  };
}

function applyState(s){
  if(!s || !s._ketadata) return;

  if(s.theme){
    if(s.theme.appBg)  appBg.value = s.theme.appBg;
    if(s.theme.docBg)  docBg.value = s.theme.docBg;
    if(s.theme.text)   textCol.value = s.theme.text;
  }

  if(s.doc){
    if(typeof s.doc.title === "string") titleEl.innerText = s.doc.title;
    if(typeof s.doc.html === "string")  editor.innerHTML = s.doc.html;

    if(typeof s.doc.fontSize === "number") fontSize.value = String(s.doc.fontSize);
    if(typeof s.doc.pad === "number")      padSize.value  = String(s.doc.pad);
    if(typeof s.doc.lineHeight === "number") lineH.value  = String(Math.round(s.doc.lineHeight*100));
  }

  // apply vars
  applyTheme();
  applyDocSizing();

  dirty = false;
  saveFlag.textContent = "SAVED";
  savedAt.textContent = `SAVED ${nowISO()}`;
  updateCounts();
}

function saveState(silent=false){
  try{
    const s = getState();
    localStorage.setItem(STATE_KEY, JSON.stringify(s));
    dirty = false;
    saveFlag.textContent = "SAVED";
    savedAt.textContent = `SAVED ${nowISO()}`;
    if(!silent) flashSaved();
  }catch(e){}
}

function loadState(){
  const raw = localStorage.getItem(STATE_KEY);
  if(!raw) return false;
  try{
    const s = JSON.parse(raw);
    applyState(s);
    return true;
  }catch(e){
    return false;
  }
}

function flashSaved(){
  const old = saveFlag.textContent;
  saveFlag.textContent = "SAVED";
  setTimeout(()=>{ saveFlag.textContent = old; }, 500);
}

function applyTheme(){
  setCSSVar("--appBg", appBg.value);
  setCSSVar("--docBg", docBg.value);
  setCSSVar("--text",  textCol.value);

  // adjust UI contrast subtly when user goes light mode:
  const isLight = luminance(hexToRgb(docBg.value)) > 0.62;
  setCSSVar("--btnBg",  isLight ? "rgba(255,255,255,.20)" : "rgba(0,0,0,.20)");
  setCSSVar("--btnBg2", isLight ? "rgba(255,255,255,.30)" : "rgba(0,0,0,.34)");
  document.body.style.color = textCol.value;
}

function applyDocSizing(){
  setCSSVar("--fontSize", `${fontSize.value}px`);
  setCSSVar("--pagePad", `${padSize.value}px`);
  const lh = (Number(lineH.value)/100).toFixed(2);
  setCSSVar("--lineHeight", lh);

  fontVal.textContent = fontSize.value;
  padVal.textContent  = padSize.value;
  lhVal.textContent   = lh;
}

function hexToRgb(hex){
  const h = hex.replace('#','').trim();
  const full = h.length===3 ? h.split('').map(c=>c+c).join('') : h;
  const n = parseInt(full,16);
  return { r:(n>>16)&255, g:(n>>8)&255, b:n&255 };
}

function luminance({r,g,b}){
  // sRGB -> linear
  const f = (v)=>{
    v/=255;
    return v <= 0.04045 ? v/12.92 : Math.pow((v+0.055)/1.055, 2.4);
  };
  const R=f(r), G=f(g), B=f(b);
  return 0.2126*R + 0.7152*G + 0.0722*B;
}

/* Bind inputs */
[appBg, docBg, textCol].forEach(x=>{
  x.addEventListener("input", ()=>{ applyTheme(); markDirty(); });
});

[fontSize, padSize, lineH].forEach(x=>{
  x.addEventListener("input", ()=>{ applyDocSizing(); markDirty(); });
});

editor.addEventListener("input", markDirty);
titleEl.addEventListener("input", markDirty);

/* Buttons */
el("btnSave").onclick   = ()=> saveState(false);

el("btnExport").onclick = ()=>{
  ioCard.style.display = "block";
  ioArea.value = JSON.stringify(getState(), null, 2);
};

el("btnImport").onclick = ()=>{
  ioCard.style.display = "block";
  ioArea.value = "";
  ioArea.focus();
};

el("btnApplyIO").onclick = ()=>{
  try{
    const s = JSON.parse(ioArea.value);
    applyState(s);
    saveState(true);
  }catch(e){}
};

el("btnCopyIO").onclick = ()=>{
  const t = ioArea.value || "";
  navigator.clipboard?.writeText(t).catch(()=>{});
};

el("btnCloseIO").onclick = ()=> ioCard.style.display = "none";

el("btnClear").onclick = ()=>{
  editor.innerHTML = "";
  markDirty();
};

el("btnReset").onclick = ()=>{
  appBg.value   = "#000000";
  docBg.value   = "#0a0a0a";
  textCol.value = "#ffffff";
  fontSize.value = "18";
  padSize.value  = "56";
  lineH.value    = "155";
  applyTheme();
  applyDocSizing();
  markDirty();
};

/* Swatches */
document.querySelectorAll(".sw").forEach(sw=>{
  sw.addEventListener("click", ()=>{
    appBg.value = sw.dataset.app;
    docBg.value = sw.dataset.doc;
    textCol.value = sw.dataset.text;
    applyTheme();
    markDirty();
  });
});

/* Hotkeys */
window.addEventListener("keydown", (e)=>{
  const mac = navigator.platform.toLowerCase().includes("mac");
  const mod = mac ? e.metaKey : e.ctrlKey;

  if(mod && e.key.toLowerCase()==="s"){
    e.preventDefault();
    saveState(false);
  }
  if(mod && e.key.toLowerCase()==="e"){
    e.preventDefault();
    ioCard.style.display = "block";
    ioArea.value = JSON.stringify(getState(), null, 2);
  }
  if(mod && e.key.toLowerCase()==="i"){
    e.preventDefault();
    ioCard.style.display = "block";
    ioArea.value = "";
    ioArea.focus();
  }
});

/* Init */
applyTheme();
applyDocSizing();
loadState() || (savedAt.textContent = "NEW");

/* counts */
updateCounts();
</script>

<!-- ============================================================
KETADATA HTML SERIALIZATION STAMP
AE/EE/WB: WB
FILE_ID: KETADATA_DOC_V1
ROOM_ID: DOC
VERSION: v1
UPDATED_AT: 2025-12-28T00:00:00-05:00
CHANGELOG:
- NEW: GOOGLE-DOC-LIKE KETADATA DOC (DARK DEFAULT) WITH LIVE COLOR CONTROLS
- ADD: APP BG / DOC BG / TEXT COLOR PICKERS + QUICK SWATCHES
- ADD: FONT SIZE / PADDING / LINE HEIGHT SLIDERS
- ADD: SAVE (LOCAL) + EXPORT/IMPORT JSON STATE
- UX: BOLD TOP BAR, SIMPLE HOTKEYS, CLEAN PAGE SHEET
============================================================ -->
</body>
</html>
