<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KETADATA // LAB</title>
  <style>
    :root{
      --bg:#000;
      --ink:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.60);
      --line:rgba(255,255,255,.12);
      --line2:rgba(255,255,255,.20);

      --r:0px;
      --pad:14px;
      --font: Arial, Helvetica, sans-serif;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background: var(--bg);
      color: var(--ink);
      overflow:hidden;
      font-family: var(--font);
    }

    /* Lab background: oscillating scan-grid + faint waveform */
    #bg{
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        linear-gradient(rgba(255,255,255,.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.05) 1px, transparent 1px);
      background-size: 48px 48px;
      opacity: .20;
      animation: drift 22s linear infinite;
      filter: contrast(1.1);
    }
    @keyframes drift{
      from{ background-position: 0 0, 0 0; }
      to{ background-position: 320px 220px, 320px 220px; }
    }

    #wave{
      position:fixed;
      inset:-80px;
      pointer-events:none;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.08), transparent 45%),
        radial-gradient(circle at 70% 60%, rgba(255,255,255,.06), transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(255,255,255,.04), transparent 60%);
      opacity:.35;
      filter: blur(18px);
      transform: translate3d(0,0,0);
      animation: swell 9.5s ease-in-out infinite alternate;
      mix-blend-mode: screen;
    }
    @keyframes swell{
      from{ transform: scale(1.0) translate3d(0,0,0); }
      to{ transform: scale(1.12) translate3d(-18px, 10px, 0); }
    }

    #vignette{
      position:fixed;
      inset:0;
      pointer-events:none;
      background: radial-gradient(circle at center, rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 65%, rgba(0,0,0,.90) 100%);
      mix-blend-mode: multiply;
    }

    .wrap{
      position:relative;
      z-index:5;
      height:100%;
      display:grid;
      grid-template-columns: minmax(340px, 580px) 1fr;
      gap: 18px;
      padding: 18px;
    }

    .left{
      border:1px solid var(--line);
      background: rgba(0,0,0,.58);
      backdrop-filter: blur(10px);
      padding: var(--pad);
      border-radius: var(--r);
      box-shadow: 0 22px 90px rgba(0,0,0,.55);
      display:flex;
      flex-direction:column;
      gap: 14px;
      align-self:start;
    }

    .hdr{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      padding-bottom:10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .brand{
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-weight:800;
      white-space:nowrap;
    }
    .room{
      font-size:11px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:rgba(255,255,255,.62);
      text-align:right;
    }

    .meta{
      display:grid;
      grid-template-columns: 1fr;
      gap:8px;
    }
    .fact{
      display:flex;
      justify-content:space-between;
      gap:12px;
      padding:10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
    }
    .k{
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:rgba(255,255,255,.62);
      white-space:nowrap;
    }
    .v{
      font-size:12px;
      color:rgba(255,255,255,.90);
      letter-spacing:.02em;
      text-align:right;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width: 380px;
    }

    .desc{
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
      padding:10px;
      color:rgba(255,255,255,.72);
      font-size:12px;
      line-height:1.35;
      letter-spacing:.01em;
    }
    .desc b{ color: rgba(255,255,255,.90); }

    .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      padding-top: 2px;
    }

    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color:rgba(255,255,255,.92);
      padding:10px 12px;
      font-size:12px;
      cursor:pointer;
      border-radius: var(--r);
      text-transform:uppercase;
      letter-spacing:.12em;
      font-weight:800;
      user-select:none;
    }
    .btn:hover{ border-color: rgba(255,255,255,.22); background: rgba(255,255,255,.06); }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary{
      font-weight:700;
      letter-spacing:.10em;
      background: rgba(255,255,255,.02);
      color: rgba(255,255,255,.84);
    }

    .right{
      border:1px solid var(--line);
      background: rgba(0,0,0,.52);
      backdrop-filter: blur(10px);
      padding: var(--pad);
      border-radius: var(--r);
      box-shadow: 0 22px 90px rgba(0,0,0,.45);
      display:flex;
      flex-direction:column;
      min-width: 260px;
    }

    .rightHdr{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      padding-bottom:10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      margin-bottom: 10px;
    }
    .rightTitle{
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-weight:800;
    }
    .rightHint{
      font-size:11px;
      color:rgba(255,255,255,.55);
      letter-spacing:.02em;
      text-align:right;
    }

    .stack{
      display:flex;
      flex-direction:column;
      gap:10px;
      overflow:auto;
      padding-right: 6px;
    }

    .card{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      padding:10px;
      text-decoration:none;
      color: var(--ink);
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height: 110px;
      cursor:pointer;
    }
    .card:hover{ border-color: rgba(255,255,255,.18); background: rgba(255,255,255,.04); }

    .cardTop{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
    }
    .cardName{
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      font-weight:800;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .tag{
      font-size:10px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(255,255,255,.62);
      white-space:nowrap;
    }
    .cardDesc{
      font-size:12px;
      color: rgba(255,255,255,.70);
      line-height:1.3;
      letter-spacing:.01em;
    }

    /* Footer hint */
    #hint{
      position:fixed;
      left:12px;
      bottom:12px;
      z-index:10;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.45);
      padding:8px 10px;
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.62);
      backdrop-filter: blur(6px);
      pointer-events:none;
    }

    /* Veil transition */
    #veil{
      position:fixed;
      inset:0;
      background:#000;
      opacity:0;
      pointer-events:none;
      transition: opacity 520ms ease;
      z-index:50;
    }
    #veil.on{ opacity:1; }

    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
      .v{ max-width: 100%; }
    }

    @media (prefers-reduced-motion: reduce){
      #bg, #wave{ animation:none; }
      #veil{ transition:none; }
    }
  </style>
</head>
<body>
  <div id="bg" aria-hidden="true"></div>
  <div id="wave" aria-hidden="true"></div>
  <div id="vignette" aria-hidden="true"></div>

  <div class="wrap">
    <!-- LEFT: LAB DESK -->
    <section class="left" aria-label="Lab Desk">
      <div class="hdr">
        <div class="brand">KETADATA</div>
        <div class="room">LAB // COGNITION</div>
      </div>

      <div class="meta">
        <div class="fact">
          <div class="k">PROTOCOL</div>
          <div class="v" id="protocolVal">EXPERIMENT</div>
        </div>
        <div class="fact">
          <div class="k">LAST INSTRUMENT</div>
          <div class="v" id="lastInstVal">—</div>
        </div>
        <div class="fact">
          <div class="k">LOGGING</div>
          <div class="v" id="loggingVal">LOCAL</div>
        </div>
      </div>

      <div class="desc">
        <b>LAB</b> is the cognitive workshop. Prompts, schemas, tests, pattern capture, controlled experiments.
        <br /><br />
        Rules: <b>measure, iterate, archive</b>. Studio manipulates media. Temple calibrates. Vault formalizes.
      </div>

      <div class="actions">
        <button class="btn" id="enterBtn">ENTER LAB</button>
        <button class="btn secondary" id="resumeBtn">RESUME LAST</button>
        <button class="btn secondary" id="routerBtn">OPEN ELEVATOR</button>
      </div>
    </section>

    <!-- RIGHT: INSTRUMENT RACK -->
    <aside class="right" aria-label="Instrument Rack">
      <div class="rightHdr">
        <div class="rightTitle">INSTRUMENTS</div>
        <div class="rightHint">click = run</div>
      </div>

      <div class="stack" id="instStack">
        <!-- populated by JS -->
      </div>
    </aside>
  </div>

  <div id="hint">ENTER: enter lab · R: resume · 1–7: instruments · ESC: cancel transition</div>
  <div id="veil"></div>

  <script>
    (() => {
      // -----------------------------
      // CONFIG
      // -----------------------------
      const LAB_HOME = "https://ketadata.com/prompt3.html";     // your current lab-ish page
      const ELEVATOR_URL = "https://ketadata.com/elevator1.html";

      const INSTRUMENTS = [
        { id:"promptbay", name:"PROMPT BAY", tag:"PROMPTS", url:"https://ketadata.com/prompt3.html", desc:"Generate, mutate, and store prompt blocks." },
        { id:"schema",    name:"SCHEMA FORGE", tag:"DB",     url:"https://ketadata.com/schema.html",  desc:"Tables, fields, relations, naming discipline." },
        { id:"ontology",  name:"ONTOLOGY GRID", tag:"MAP",   url:"https://ketadata.com/ontology.html",desc:"Entities, rooms, primitives, constraints." },
        { id:"ritual",    name:"RITUAL ENGINE", tag:"PROTO", url:"https://ketadata.com/ritual.html",  desc:"Repeatable sequences; triggers; timers." },
        { id:"tests",     name:"TEST BENCH", tag:"EVAL",     url:"https://ketadata.com/tests.html",   desc:"Comparisons, scoring rubrics, A/B notes." },
        { id:"log",       name:"EXPERIMENT LOG", tag:"LOG",  url:"https://ketadata.com/log.html",     desc:"Timestamped entries; hypotheses; outcomes." },
        { id:"models",    name:"MODEL NOTES", tag:"AI",      url:"https://ketadata.com/models.html",  desc:"Model capabilities, prompts, failure modes." }
      ];

      // Storage keys
      const KEY_LAST_INST_NAME = "ketadata_lab_last_inst_name";
      const KEY_LAST_INST_URL  = "ketadata_lab_last_inst_url";
      const KEY_PROTOCOL       = "ketadata_lab_protocol"; // EXPERIMENT / ANALYSIS / BUILD

      // -----------------------------
      // DOM
      // -----------------------------
      const instStack = document.getElementById("instStack");
      const enterBtn  = document.getElementById("enterBtn");
      const resumeBtn = document.getElementById("resumeBtn");
      const routerBtn = document.getElementById("routerBtn");
      const veil      = document.getElementById("veil");

      const protocolVal = document.getElementById("protocolVal");
      const lastInstVal = document.getElementById("lastInstVal");
      const loggingVal  = document.getElementById("loggingVal");

      // -----------------------------
      // State helpers
      // -----------------------------
      function getProtocol(){
        return (localStorage.getItem(KEY_PROTOCOL) || "EXPERIMENT").toUpperCase();
      }
      function getLastInst(){
        return {
          name: localStorage.getItem(KEY_LAST_INST_NAME) || "—",
          url: localStorage.getItem(KEY_LAST_INST_URL) || ""
        };
      }
      function setLastInst(name, url){
        try{
          localStorage.setItem(KEY_LAST_INST_NAME, name);
          localStorage.setItem(KEY_LAST_INST_URL, url);
        }catch(_){}
      }

      function updateDesk(){
        protocolVal.textContent = getProtocol();
        const last = getLastInst();
        lastInstVal.textContent = last.name;
        loggingVal.textContent = "LOCAL";

        resumeBtn.disabled = !last.url;
        resumeBtn.style.opacity = last.url ? "1" : ".45";
        resumeBtn.style.cursor = last.url ? "pointer" : "not-allowed";
      }

      // -----------------------------
      // Navigation (veil)
      // -----------------------------
      let navLock = false;
      function route(name, url){
        if(navLock) return;
        navLock = true;
        if(name && url) setLastInst(name, url);

        veil.classList.add("on");
        setTimeout(() => window.location.href = url, 520);
      }

      // -----------------------------
      // Build instrument stack
      // -----------------------------
      function buildInstruments(){
        instStack.innerHTML = "";
        INSTRUMENTS.forEach((t, idx) => {
          const a = document.createElement("a");
          a.className = "card";
          a.href = t.url;
          a.dataset.key = String(idx + 1);
          a.innerHTML = `
            <div class="cardTop">
              <div class="cardName">${t.name}</div>
              <div class="tag">${t.tag}</div>
            </div>
            <div class="cardDesc">${t.desc}</div>
          `;
          a.addEventListener("click", (e) => {
            e.preventDefault();
            route(t.name, t.url);
          });
          instStack.appendChild(a);
        });
      }

      // -----------------------------
      // Buttons
      // -----------------------------
      enterBtn.addEventListener("click", () => route("LAB", LAB_HOME));

      resumeBtn.addEventListener("click", () => {
        const last = getLastInst();
        if (!last.url) return;
        route(last.name, last.url);
      });

      routerBtn.addEventListener("click", () => route("ELEVATOR", ELEVATOR_URL));

      // -----------------------------
      // Hotkeys
      // -----------------------------
      window.addEventListener("keydown", (e) => {
        const k = e.key.toLowerCase();

        if (k === "escape"){
          veil.classList.remove("on");
          navLock = false;
          return;
        }

        // Enter: go to Lab home
        if (k === "enter"){
          route("LAB", LAB_HOME);
        }

        // R: resume last
        if (k === "r"){
          const last = getLastInst();
          if (last.url) route(last.name, last.url);
        }

        // 1–7: quick launch
        const n = Number(e.key);
        if (n >= 1 && n <= INSTRUMENTS.length){
          const t = INSTRUMENTS[n - 1];
          route(t.name, t.url);
        }
      });

      // init
      buildInstruments();
      updateDesk();
    })();
  </script>
</body>
</html>
