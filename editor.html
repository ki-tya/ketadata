<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KETADATA Photo Editor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: black;
            color: white;
            min-height: 100vh;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            border: 2px solid #333;
            padding: 20px;
            margin-bottom: 20px;
            background: #000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            letter-spacing: 3px;
        }

        .logo-data {
            background: #ff0000;
            color: #000;
            padding: 4px 12px;
            margin-left: 5px;
        }

        .status {
            font-size: 0.9em;
            color: #555;
        }

        .upload-zone {
            border: 3px dashed #333;
            padding: 60px;
            text-align: center;
            margin-bottom: 20px;
            background: #000;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .upload-zone:hover {
            border-color: white;
        }

        .upload-zone.drag-over {
            border-color: white;
            background: #111;
        }

        .upload-text {
            font-size: 1.2em;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .upload-subtext {
            color: #555;
            font-size: 0.85em;
        }

        .controls {
            border: 2px solid #333;
            padding: 20px;
            margin-bottom: 20px;
            background: #000;
        }

        .control-section {
            margin-bottom: 20px;
        }

        .control-title {
            font-size: 0.9em;
            margin-bottom: 10px;
            color: white;
            letter-spacing: 2px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }

        .control-btn {
            padding: 12px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: white;
            font-family: Arial, sans-serif;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-btn:hover {
            background: #222;
            border-color: white;
        }

        .control-btn.active {
            background: white;
            color: black;
            border-color: white;
        }

        .slider-control {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .slider-label {
            font-size: 0.85em;
            color: #555;
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: white;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: white;
            cursor: pointer;
            border: none;
        }

        .action-bar {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 15px;
            background: #1a1a1a;
            border: 2px solid #333;
            color: white;
            font-family: Arial, sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .action-btn:hover {
            background: #222;
            border-color: white;
        }

        .action-btn.danger {
            border-color: #ff0000;
            color: #ff0000;
        }

        .action-btn.danger:hover {
            background: #220000;
            border-color: #ff0000;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .gallery.cols-1 { grid-template-columns: 1fr; }
        .gallery.cols-2 { grid-template-columns: repeat(2, 1fr); }
        .gallery.cols-3 { grid-template-columns: repeat(3, 1fr); }
        .gallery.cols-4 { grid-template-columns: repeat(4, 1fr); }

        .image-slot {
            aspect-ratio: 1;
            border: 2px solid #333;
            background: #000;
            position: relative;
            overflow: hidden;
        }

        .image-slot canvas {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .image-slot .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: #ff0000;
            color: #000;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            line-height: 1;
            display: none;
        }

        .image-slot:hover .remove-btn {
            display: block;
        }

        .overlay-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
        }

        .overlay-selector select {
            flex: 1;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: white;
            font-family: Arial, sans-serif;
        }

        @media (max-width: 1200px) {
            .gallery {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .gallery {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .control-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <span>KETA</span><span class="logo-data">DATA</span> PHOTO EDITOR
            </div>
            <div class="status" id="status">READY</div>
        </div>

        <div class="upload-zone" id="uploadZone">
            <div class="upload-text">DROP IMAGES OR CLICK TO UPLOAD</div>
            <div class="upload-subtext">MAX 16 IMAGES · JPG, PNG, GIF, WEBP</div>
            <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
        </div>

        <div class="controls" id="controls" style="display: none;">
            <div class="control-section">
                <div class="control-title">// BASIC EFFECTS</div>
                <div class="control-grid">
                    <button class="control-btn" onclick="applyEffect('invert')">INVERT</button>
                    <button class="control-btn" onclick="applyEffect('grayscale')">GRAYSCALE</button>
                    <button class="control-btn" onclick="applyEffect('xray')">X-RAY</button>
                    <button class="control-btn" onclick="applyEffect('chromatic')">CHROMATIC</button>
                    <button class="control-btn" onclick="applyEffect('sonar')">SONAR</button>
                    <button class="control-btn" onclick="applyEffect('wireframe')">WIREFRAME</button>
                    <button class="control-btn" onclick="applyEffect('lofi')">LO-FI</button>
                    <button class="control-btn" onclick="applyEffect('crunchy')">CRUNCHY</button>
                    <button class="control-btn" onclick="applyEffect('fried')">FRIED</button>
                    <button class="control-btn" onclick="applyEffect('infrared')">INFRA-RED</button>
                    <button class="control-btn" onclick="applyEffect('nightvision')">NIGHT VISION</button>
                    <button class="control-btn" onclick="applyEffect('surveillance')">SURVEILLANCE</button>
                </div>
            </div>

            <div class="control-section">
                <div class="control-title">// ADJUSTMENTS</div>
                <div class="control-grid">
                    <div class="slider-control">
                        <div class="slider-label">BRIGHTNESS: <span id="brightnessVal">100</span>%</div>
                        <input type="range" id="brightness" min="0" max="200" value="100">
                    </div>
                    <div class="slider-control">
                        <div class="slider-label">CONTRAST: <span id="contrastVal">100</span>%</div>
                        <input type="range" id="contrast" min="0" max="200" value="100">
                    </div>
                    <div class="slider-control">
                        <div class="slider-label">SATURATION: <span id="saturationVal">100</span>%</div>
                        <input type="range" id="saturation" min="0" max="200" value="100">
                    </div>
                    <div class="slider-control">
                        <div class="slider-label">NOISE: <span id="noiseVal">0</span>%</div>
                        <input type="range" id="noise" min="0" max="100" value="0">
                    </div>
                </div>
            </div>

            <div class="control-section">
                <div class="control-title">// OVERLAY</div>
                <div class="overlay-selector">
                    <select id="overlayImage1">
                        <option value="">IMAGE 1: NONE</option>
                    </select>
                    <select id="overlayImage2">
                        <option value="">IMAGE 2: NONE</option>
                    </select>
                    <div class="slider-control" style="flex: 1;">
                        <div class="slider-label">OPACITY: <span id="overlayOpacityVal">50</span>%</div>
                        <input type="range" id="overlayOpacity" min="0" max="100" value="50">
                    </div>
                    <button class="control-btn" onclick="applyOverlay()">APPLY OVERLAY</button>
                </div>
            </div>

            <div class="action-bar">
                <button class="action-btn" onclick="resetAll()">RESET ALL</button>
                <button class="action-btn" onclick="downloadAll()">DOWNLOAD ALL</button>
                <button class="action-btn danger" onclick="clearAll()">CLEAR ALL</button>
            </div>
        </div>

        <div class="gallery" id="gallery"></div>
    </div>

    <script>
        let images = [];
        let originalImages = [];
        const MAX_IMAGES = 16;

        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const gallery = document.getElementById('gallery');
        const controls = document.getElementById('controls');
        const status = document.getElementById('status');

        // Upload handlers
        uploadZone.addEventListener('click', () => fileInput.click());
        
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('drag-over');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('drag-over');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
            handleFiles(e.dataTransfer.files);
        });

        function handleFiles(files) {
            const fileArray = Array.from(files).slice(0, MAX_IMAGES - images.length);
            
            fileArray.forEach(file => {
                if (!file.type.startsWith('image/')) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        images.push(img);
                        originalImages.push(img.cloneNode(true));
                        updateGallery();
                        updateOverlaySelectors();
                        if (images.length > 0) {
                            controls.style.display = 'block';
                            uploadZone.style.display = 'none';
                        }
                        updateStatus(`LOADED ${images.length}/${MAX_IMAGES} IMAGES`);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        function updateGallery() {
            gallery.innerHTML = '';
            
            // Adjust grid columns
            if (images.length <= 1) gallery.className = 'gallery cols-1';
            else if (images.length <= 4) gallery.className = 'gallery cols-2';
            else if (images.length <= 9) gallery.className = 'gallery cols-3';
            else gallery.className = 'gallery cols-4';

            images.forEach((img, index) => {
                const slot = document.createElement('div');
                slot.className = 'image-slot';
                
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.textContent = '×';
                removeBtn.onclick = () => removeImage(index);
                
                slot.appendChild(canvas);
                slot.appendChild(removeBtn);
                gallery.appendChild(slot);
            });
        }

        function removeImage(index) {
            images.splice(index, 1);
            originalImages.splice(index, 1);
            updateGallery();
            updateOverlaySelectors();
            updateStatus(`REMOVED IMAGE · ${images.length} REMAINING`);
            
            if (images.length === 0) {
                controls.style.display = 'none';
                uploadZone.style.display = 'block';
            }
        }

        function updateOverlaySelectors() {
            const select1 = document.getElementById('overlayImage1');
            const select2 = document.getElementById('overlayImage2');
            
            select1.innerHTML = '<option value="">IMAGE 1: NONE</option>';
            select2.innerHTML = '<option value="">IMAGE 2: NONE</option>';
            
            images.forEach((_, index) => {
                select1.innerHTML += `<option value="${index}">IMAGE ${index + 1}</option>`;
                select2.innerHTML += `<option value="${index}">IMAGE ${index + 1}</option>`;
            });
        }

        function applyEffect(effect) {
            updateStatus(`APPLYING ${effect.toUpperCase()}...`);
            
            const canvases = gallery.querySelectorAll('canvas');
            
            canvases.forEach((canvas, index) => {
                const ctx = canvas.getContext('2d');
                const img = images[index];
                
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                switch(effect) {
                    case 'invert':
                        for (let i = 0; i < data.length; i += 4) {
                            data[i] = 255 - data[i];
                            data[i + 1] = 255 - data[i + 1];
                            data[i + 2] = 255 - data[i + 2];
                        }
                        break;
                        
                    case 'grayscale':
                        for (let i = 0; i < data.length; i += 4) {
                            const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                            data[i] = data[i + 1] = data[i + 2] = gray;
                        }
                        break;
                        
                    case 'xray':
                        for (let i = 0; i < data.length; i += 4) {
                            data[i] = 255 - data[i];
                            data[i + 1] = 255 - data[i + 1];
                            data[i + 2] = 255 - data[i + 2];
                            const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                            data[i] = data[i + 1] = data[i + 2] = gray;
                        }
                        break;
                        
                    case 'chromatic':
                        for (let i = 0; i < data.length; i += 4) {
                            const offset = 5;
                            if (i > offset * 4) {
                                data[i] = data[i - offset * 4];
                            }
                        }
                        break;
                        
                    case 'sonar':
                        for (let i = 0; i < data.length; i += 4) {
                            const intensity = (data[i] + data[i + 1] + data[i + 2]) / 3;
                            data[i] = 0;
                            data[i + 1] = intensity;
                            data[i + 2] = intensity * 0.5;
                        }
                        break;
                        
                    case 'wireframe':
                        for (let i = 0; i < data.length; i += 4) {
                            const edge = Math.abs(data[i] - data[i + 4]) + 
                                       Math.abs(data[i + 1] - data[i + 5]) +
                                       Math.abs(data[i + 2] - data[i + 6]);
                            data[i] = data[i + 1] = data[i + 2] = edge > 50 ? 255 : 0;
                        }
                        break;
                        
                    case 'lofi':
                        for (let i = 0; i < data.length; i += 4) {
                            data[i] = Math.floor(data[i] / 64) * 64;
                            data[i + 1] = Math.floor(data[i + 1] / 64) * 64;
                            data[i + 2] = Math.floor(data[i + 2] / 64) * 64;
                        }
                        break;
                        
                    case 'crunchy':
                        for (let i = 0; i < data.length; i += 4) {
                            data[i] = Math.floor(data[i] / 32) * 32;
                            data[i + 1] = Math.floor(data[i + 1] / 32) * 32;
                            data[i + 2] = Math.floor(data[i + 2] / 32) * 32;
                            if (Math.random() > 0.95) {
                                data[i] = data[i + 1] = data[i + 2] = Math.random() * 255;
                            }
                        }
                        break;
                        
                    case 'fried':
                        for (let i = 0; i < data.length; i += 4) {
                            data[i] = Math.min(255, data[i] * 1.5 + 50);
                            data[i + 1] = Math.min(255, data[i + 1] * 0.8);
                            data[i + 2] = Math.min(255, data[i + 2] * 0.8);
                            const boost = Math.random() * 100;
                            data[i] = Math.min(255, data[i] + boost);
                        }
                        break;
                        
                    case 'infrared':
                        for (let i = 0; i < data.length; i += 4) {
                            const temp = data[i];
                            data[i] = data[i + 2];
                            data[i + 2] = temp;
                            data[i] = Math.min(255, data[i] * 1.3);
                        }
                        break;
                        
                    case 'nightvision':
                        for (let i = 0; i < data.length; i += 4) {
                            const brightness = (data[i] + data[i + 1] + data[i + 2]) / 3;
                            data[i] = 0;
                            data[i + 1] = Math.min(255, brightness * 1.5);
                            data[i + 2] = 0;
                        }
                        break;
                        
                    case 'surveillance':
                        for (let i = 0; i < data.length; i += 4) {
                            const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                            data[i] = data[i + 1] = data[i + 2] = gray * 0.8;
                            if (Math.random() > 0.98) {
                                data[i] = data[i + 1] = data[i + 2] = 0;
                            }
                        }
                        break;
                }
                
                ctx.putImageData(imageData, 0, 0);
            });
            
            updateStatus(`${effect.toUpperCase()} APPLIED`);
        }

        function applyOverlay() {
            const idx1 = document.getElementById('overlayImage1').value;
            const idx2 = document.getElementById('overlayImage2').value;
            
            if (!idx1 || !idx2 || idx1 === idx2) {
                updateStatus('ERROR: SELECT TWO DIFFERENT IMAGES');
                return;
            }
            
            const opacity = document.getElementById('overlayOpacity').value / 100;
            const canvases = gallery.querySelectorAll('canvas');
            
            const canvas1 = canvases[idx1];
            const canvas2 = canvases[idx2];
            
            const ctx = canvas1.getContext('2d');
            ctx.globalAlpha = opacity;
            ctx.drawImage(canvas2, 0, 0, canvas1.width, canvas1.height);
            ctx.globalAlpha = 1.0;
            
            updateStatus('OVERLAY APPLIED');
        }

        function resetAll() {
            images = originalImages.map(img => img.cloneNode(true));
            updateGallery();
            updateStatus('RESET TO ORIGINAL');
        }

        function downloadAll() {
            const canvases = gallery.querySelectorAll('canvas');
            canvases.forEach((canvas, index) => {
                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ketadata_${Date.now()}_${index + 1}.png`;
                    a.click();
                    URL.revokeObjectURL(url);
                });
            });
            updateStatus(`DOWNLOADING ${canvases.length} IMAGES...`);
        }

        function clearAll() {
            if (confirm('CLEAR ALL IMAGES?')) {
                images = [];
                originalImages = [];
                gallery.innerHTML = '';
                controls.style.display = 'none';
                uploadZone.style.display = 'block';
                updateStatus('CLEARED');
            }
        }

        function updateStatus(msg) {
            status.textContent = msg;
        }

        // Slider updates
        document.getElementById('brightness').addEventListener('input', function() {
            document.getElementById('brightnessVal').textContent = this.value;
            applyAdjustments();
        });

        document.getElementById('contrast').addEventListener('input', function() {
            document.getElementById('contrastVal').textContent = this.value;
            applyAdjustments();
        });

        document.getElementById('saturation').addEventListener('input', function() {
            document.getElementById('saturationVal').textContent = this.value;
            applyAdjustments();
        });

        document.getElementById('noise').addEventListener('input', function() {
            document.getElementById('noiseVal').textContent = this.value;
            applyAdjustments();
        });

        document.getElementById('overlayOpacity').addEventListener('input', function() {
            document.getElementById('overlayOpacityVal').textContent = this.value;
        });

        function applyAdjustments() {
            const brightness = document.getElementById('brightness').value / 100;
            const contrast = document.getElementById('contrast').value / 100;
            const saturation = document.getElementById('saturation').value / 100;
            const noise = document.getElementById('noise').value / 100;
            
            const canvases = gallery.querySelectorAll('canvas');
            
            canvases.forEach((canvas, index) => {
                const ctx = canvas.getContext('2d');
                const img = images[index];
                
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                for (let i = 0; i < data.length; i += 4) {
                    // Brightness
                    data[i] *= brightness;
                    data[i + 1] *= brightness;
                    data[i + 2] *= brightness;
                    
                    // Contrast
                    data[i] = ((data[i] - 128) * contrast) + 128;
                    data[i + 1] = ((data[i + 1] - 128) * contrast) + 128;
                    data[i + 2] = ((data[i + 2] - 128) * contrast) + 128;
                    
                    // Saturation
                    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                    data[i] = gray + (data[i] - gray) * saturation;
                    data[i + 1] = gray + (data[i + 1] - gray) * saturation;
                    data[i + 2] = gray + (data[i + 2] - gray) * saturation;
                    
                    // Noise
                    if (Math.random() < noise) {
                        const n = Math.random() * 255;
                        data[i] = data[i + 1] = data[i + 2] = n;
                    }
                    
                    // Clamp
                    data[i] = Math.max(0, Math.min(255, data[i]));
                    data[i + 1] = Math.max(0, Math.min(255, data[i + 1]));
                    data[i + 2] = Math.max(0, Math.min(255, data[i + 2]));
                }
                
                ctx.putImageData(imageData, 0, 0);
            });
        }
    </script>
</body>
</html>
