<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>KETADATA // BLACK BOOK SCANNER</title>

<!-- AE ▸ BLACK GLASS / ARCHIVIST TABLE -->
<style>
:root{
  --bg:#000;
  --ink:#fff;
  --muted:#777;
  --hair:#111;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink)}
body{font-family:Arial,system-ui;overflow:hidden}

#stage{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

#page{
  max-height:72vh;
  max-width:90vw;
  object-fit:contain;
  background:#000;
  transition:filter .15s, transform .15s;
}

#strip{
  height:96px;
  width:100%;
  border-top:1px solid var(--hair);
  display:flex;
  overflow-x:auto;
  padding:6px;
  gap:6px;
}

.thumb{
  height:80px;
  opacity:.45;
  cursor:pointer;
}
.thumb.active{opacity:1;outline:1px solid #fff}

#hud{
  position:absolute;
  top:10px;
  left:10px;
  font-family:ui-monospace,monospace;
  font-size:11px;
  color:var(--muted);
}

.hidden{display:none}
</style>
</head>

<body>

<div id="stage">
  <img id="page" />
  <div id="strip"></div>
</div>

<div id="hud">
  DROP IMAGES · ← → FLIP · I INVERT · [ ] CONTRAST · - = SCALE · H HIDE
</div>

<input id="picker" type="file" accept="image/*" multiple hidden>

<!-- EE ▸ ENGINE -->
<script>
let pages=[], idx=0;
let invert=false, contrast=1, scale=1;

const pageEl = document.getElementById("page");
const strip = document.getElementById("strip");
const hud = document.getElementById("hud");
const picker = document.getElementById("picker");

/* WB ▸ LOAD IMAGES */
function loadFiles(files){
  pages = [...files].sort((a,b)=>a.name.localeCompare(b.name));
  idx=0;
  renderStrip();
  show();
}

function renderStrip(){
  strip.innerHTML="";
  pages.forEach((f,i)=>{
    const t=document.createElement("img");
    t.src=URL.createObjectURL(f);
    t.className="thumb"+(i===0?" active":"");
    t.onclick=()=>{idx=i;show()};
    strip.appendChild(t);
  });
}

function show(){
  if(!pages.length) return;
  pageEl.src=URL.createObjectURL(pages[idx]);
  [...strip.children].forEach((t,i)=>t.classList.toggle("active",i===idx));
  applyFX();
}

function applyFX(){
  pageEl.style.filter = `
    invert(${invert?1:0})
    contrast(${contrast})
  `;
  pageEl.style.transform = `scale(${scale})`;
}

/* WB ▸ EVENTS */
document.body.ondragover=e=>e.preventDefault();
document.body.ondrop=e=>{
  e.preventDefault();
  loadFiles(e.dataTransfer.files);
};

document.body.onkeydown=e=>{
  if(e.key==="ArrowRight"){idx=Math.min(idx+1,pages.length-1);show()}
  if(e.key==="ArrowLeft"){idx=Math.max(idx-1,0);show()}
  if(e.key==="i"){invert=!invert;applyFX()}
  if(e.key==="["){contrast=Math.max(.5,contrast-.1);applyFX()}
  if(e.key==="]"){contrast=Math.min(3,contrast+.1);applyFX()}
  if(e.key==="-"){scale=Math.max(.5,scale-.05);applyFX()}
  if(e.key==="="){scale=Math.min(2,scale+.05);applyFX()}
  if(e.key==="h"){hud.classList.toggle("hidden")}
};

document.body.onclick=()=>picker.click();
picker.onchange=e=>loadFiles(e.target.files);
</script>

</body>
</html>
