<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KETADATA — PROMPT GENERATOR</title>
  <style>
    :root{
      --bg:#000000;
      --panel: rgba(255,255,255,.03);
      --line: rgba(255,255,255,.12);
      --hair: rgba(255,255,255,.16);
      --txt: rgba(255,255,255,.88);
      --muted: rgba(255,255,255,.55);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --ui: Arial, Helvetica, sans-serif;

      --a:#ff2a2a;   /* record */
      --b:#7a00ff;   /* uv */
      --c:#00eaff;   /* xray-cyan */
      --med:#00ff66; /* med-green */
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--ui);
      color:var(--txt);
      background:
        radial-gradient(circle at 20% 20%, rgba(122,0,255,.18), transparent 55%),
        radial-gradient(circle at 80% 20%, rgba(255,42,42,.16), transparent 55%),
        radial-gradient(circle at 50% 92%, rgba(0,234,255,.10), transparent 55%),
        var(--bg);
    }

    header{
      position:sticky; top:0; z-index:10;
      background: linear-gradient(to bottom, rgba(0,0,0,.88), rgba(0,0,0,.55));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--line);
    }
    .topbar{
      max-width:1200px; margin:0 auto;
      padding: 10px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      font-family:var(--mono);
      letter-spacing:.18em;
      text-transform:uppercase;
      font-size:12px;
      color: rgba(255,255,255,.78);
      white-space:nowrap;
    }
    .brand b{ color:#fff; letter-spacing:.22em; }
    .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; }
    button{
      cursor:pointer;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.14em;
      text-transform:uppercase;
      padding: 9px 10px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
      color: #666;
    }
    button:hover{ color:#fff; border-color: rgba(255,255,255,.28); background: rgba(255,255,255,.06); }
    button.danger{ border-color: rgba(255,42,42,.35); }
    button.danger:hover{ background: rgba(255,42,42,.12); }

    main{
      max-width:1200px;
      margin: 0 auto;
      padding: 14px;
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
      min-height: calc(100vh - 54px);
    }
    @media (max-width: 980px){
      main{ grid-template-columns:1fr; }
    }

    .panel{
      border: 1px solid var(--hair);
      background: linear-gradient(to bottom, rgba(255,255,255,.03), rgba(255,255,255,.01));
      box-shadow: 0 0 0 1px rgba(0,0,0,.9) inset;
      overflow:hidden;
    }
    .ph{
      padding: 10px 12px;
      border-bottom: 1px solid var(--line);
      background: rgba(0,0,0,.40);
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .ph .t{
      font-family:var(--mono);
      letter-spacing:.16em;
      text-transform:uppercase;
      font-size:11px;
      color: rgba(255,255,255,.85);
    }
    .ph .s{
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
      color: rgba(255,255,255,.50);
      white-space:nowrap;
    }
    .body{ padding: 12px; }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 680px){
      .grid{ grid-template-columns:1fr; }
    }

    label{
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(255,255,255,.70);
      display:flex; justify-content:space-between; gap:10px;
      margin-bottom:6px;
    }
    label span{ color: rgba(255,255,255,.45); }

    input[type="text"], textarea, select{
      width:100%;
      padding: 10px 10px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      color: rgba(255,255,255,.92);
      outline:none;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
    }
    textarea{ min-height: 108px; resize:vertical; }
    input::placeholder, textarea::placeholder{ color: rgba(255,255,255,.28); }

    .row{
      border: 1px solid var(--line);
      background: rgba(0,0,0,.30);
      padding: 10px;
    }
    .btns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }

    .pillRow{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:8px;
    }
    .pill{
      display:flex; align-items:center; gap:8px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      padding: 7px 8px;
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(255,255,255,.72);
      user-select:none;
      cursor:pointer;
    }
    .pill i{
      display:inline-block;
      width:10px; height:10px;
      border:1px solid rgba(255,255,255,.14);
      background: var(--p, #111);
    }
    .pill.on{ border-color: rgba(255,255,255,.28); background: rgba(255,255,255,.05); color:#fff; }

    .note{
      margin-top:10px;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
      color: rgba(255,255,255,.45);
      line-height: 1.55;
    }

    .out{
      width:100%;
      min-height: 360px;
      white-space:pre-wrap;
      word-break:break-word;
      line-height:1.45;
    }

    .mini{
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.12em;
      color: rgba(255,255,255,.55);
      margin-top:8px;
      display:flex;
      justify-content:space-between;
      gap:10px;
    }

    .kbd{
      font-family:var(--mono);
      border: 1px solid rgba(255,255,255,.18);
      padding: 2px 6px;
      color: rgba(255,255,255,.80);
      background: rgba(255,255,255,.03);
    }
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <div class="brand"><b>KETA /// DATA</b> <span>PROMPT GENERATOR</span></div>
      <div class="actions">
        <button id="generate">[GENERATE]</button>
        <button id="copy">[COPY PROMPT]</button>
        <button id="exportJson">[EXPORT JSON]</button>
        <button class="danger" id="reset">[RESET]</button>
      </div>
    </div>
  </header>

  <main>
    <!-- INPUT -->
    <section class="panel">
      <div class="ph">
        <div class="t">[INPUTS]</div>
        <div class="s">JOURNALISTIC QUESTIONS → ONE-LINE → TAGS → REFS</div>
      </div>
      <div class="body">
        <div class="grid">
          <div class="row">
            <label>MODE <span>prompt shape</span></label>
            <select id="mode">
              <option value="analysis" selected>REPORT / ANALYSIS</option>
              <option value="story">NARRATIVE / EDITORIAL</option>
              <option value="brief">EXECUTIVE BRIEF</option>
              <option value="plan">ACTION PLAN</option>
              <option value="deck">SLIDE / DECK OUTLINE</option>
            </select>

            <div class="pillRow" id="toggles">
              <div class="pill on" data-k="structure"><i style="--p:var(--c)"></i>STRUCTURE</div>
              <div class="pill on" data-k="citations"><i style="--p:var(--med)"></i>CITABLE</div>
              <div class="pill on" data-k="tone"><i style="--p:var(--b)"></i>KETADATA TONE</div>
              <div class="pill" data-k="steps"><i style="--p:var(--a)"></i>STEP-BY-STEP</div>
              <div class="pill" data-k="checklist"><i style="--p:var(--c)"></i>CHECKLIST</div>
              <div class="pill" data-k="questions"><i style="--p:var(--b)"></i>FOLLOW-UPS</div>
            </div>

            <p class="note">
              Toggle intent. Output stays minimalistic and “watchface container” style.
            </p>
          </div>

          <div class="row">
            <label>ONE-LINE SUMMARY <span>what is this about?</span></label>
            <input id="summary" type="text" maxlength="140" placeholder="E.g., Map the KETADATA Observatory floors and capacity rules for engagement." />
            <p class="note">
              Keep it blunt. This becomes the “mission line” inside the prompt.
            </p>
          </div>
        </div>

        <div class="grid" style="margin-top:12px;">
          <div class="row">
            <label>JOURNALISTIC QUESTIONS <span>who/what/when/where/why/how</span></label>
            <textarea id="questions" placeholder="One per line:
WHO is the user?
WHAT do they do first?
WHEN does the system refresh?
WHERE do the floors live?
WHY would they return?
HOW do limits create engagement?"></textarea>

            <div class="btns">
              <button id="fillW">[FILL W6]</button>
              <button id="clearQ">[CLEAR]</button>
            </div>
          </div>

          <div class="row">
            <label>TAGS <span>comma-separated</span></label>
            <input id="tags" type="text" placeholder="e.g., observatory, elevator, progressive-disclosure, hotel-california, capacity, units" />

            <label style="margin-top:12px;">REFS / SOURCE LINKS <span>one per line</span></label>
            <textarea id="refs" placeholder="Paste links, filenames, or note IDs here."></textarea>

            <label style="margin-top:12px;">OUTPUT CONSTRAINTS <span>optional</span></label>
            <textarea id="constraints" placeholder="e.g., No emojis. 11pt text. Headings bold. Provide diagram + supporting notes."></textarea>
          </div>
        </div>

        <div class="row" style="margin-top:12px;">
          <label>DELIVERABLES <span>what should the AI produce?</span></label>
          <textarea id="deliverables" placeholder="- System map with floors + facilities
- Progressive disclosure UI strategy
- Engagement loop notes
- JSON schema for units/limits"></textarea>

          <div class="btns">
            <button id="generate2">[GENERATE]</button>
            <button id="savePreset">[SAVE PRESET]</button>
            <button id="loadPreset">[LOAD PRESET]</button>
          </div>

          <p class="note">
            <span class="kbd">CTRL/⌘ + ENTER</span> generates. Preset saves locally in this browser.
          </p>
        </div>
      </div>
    </section>

    <!-- OUTPUT -->
    <section class="panel">
      <div class="ph">
        <div class="t">[READY-MADE AI PROMPT]</div>
        <div class="s">COPY → PASTE INTO MODEL</div>
      </div>
      <div class="body">
        <textarea id="out" class="out" placeholder="Generated prompt will appear here…" readonly></textarea>
        <div class="mini">
          <div>CHARS: <span id="chars">0</span></div>
          <div>PRESET: <span id="presetStatus">NONE</span></div>
        </div>
        <p class="note">
          Output is designed to be model-agnostic: works for ChatGPT / Claude / Gemini / etc.
        </p>
      </div>
    </section>
  </main>

  <script>
    // ---- clipboard helper
    async function copyText(t){
      try{ await navigator.clipboard.writeText(t); }
      catch(e){
        const ta=document.createElement("textarea");
        ta.value=t; document.body.appendChild(ta);
        ta.select(); document.execCommand("copy"); ta.remove();
      }
    }

    const els = {
      mode: document.getElementById("mode"),
      summary: document.getElementById("summary"),
      questions: document.getElementById("questions"),
      tags: document.getElementById("tags"),
      refs: document.getElementById("refs"),
      constraints: document.getElementById("constraints"),
      deliverables: document.getElementById("deliverables"),
      out: document.getElementById("out"),
      chars: document.getElementById("chars"),
      presetStatus: document.getElementById("presetStatus"),
      toggles: document.getElementById("toggles"),
    };

    const toggleState = {
      structure: true,
      citations: true,
      tone: true,
      steps: false,
      checklist: false,
      questions: false,
    };

    function readToggles(){
      return {...toggleState};
    }

    els.toggles.addEventListener("click", (e)=>{
      const pill = e.target.closest(".pill");
      if(!pill) return;
      const k = pill.dataset.k;
      toggleState[k] = !toggleState[k];
      pill.classList.toggle("on", toggleState[k]);
    });

    function cleanLines(s){
      return (s||"")
        .split("\n")
        .map(x=>x.trim())
        .filter(Boolean);
    }

    function modeDirective(mode){
      switch(mode){
        case "analysis": return "Produce a rigorous report with clear sections, assumptions, and explicit reasoning.";
        case "story": return "Produce an editorial/narrative response with controlled style and strong scene logic.";
        case "brief": return "Produce an executive brief: tight, prioritized, decision-oriented.";
        case "plan": return "Produce a structured plan: phases, steps, dependencies, acceptance criteria.";
        case "deck": return "Produce a slide/deck outline: slide titles, bullets, speaker notes, and key visuals.";
        default: return "Produce a structured response.";
      }
    }

    function ketadataToneDirective(tog){
      if(!tog.tone) return "";
      return [
        "Maintain KETADATA tone: ultra-minimal, exposed watchface containers, crisp labels, cold clarity with controlled surrealism.",
        "Experience metaphor: White Lotus hotel / skyscraper + basement + parking + mall; user feel = Alice/Wendy; curiosity-led progressive disclosure.",
        "Do not moralize. User agency is primary; system only defines capacity, units, and affordances."
      ].join("\n");
    }

    function structureDirective(tog){
      if(!tog.structure) return "Format may be freeform, but keep it readable.";
      const parts = [
        "Use headings with **bold** titles.",
        "Prefer short paragraphs and bullet lists.",
        "Include a final 'NEXT ACTIONS' section."
      ];
      if(tog.checklist) parts.push("Include a checklist with boxes [ ] for implementation.");
      if(tog.steps) parts.push("Include step-by-step procedures with numbered lists.");
      return parts.join("\n");
    }

    function citationsDirective(tog){
      if(!tog.citations) return "";
      return "When referencing sources provided under REFS, cite them by filename/link label inline.";
    }

    function followupsDirective(tog){
      if(!tog.questions) return "";
      return "End with 5–10 sharp follow-up questions that would improve accuracy (no fluff).";
    }

    function buildPrompt(){
      const tog = readToggles();
      const summary = (els.summary.value||"").trim();
      const qs = cleanLines(els.questions.value);
      const tags = (els.tags.value||"").trim();
      const refs = cleanLines(els.refs.value);
      const constraints = (els.constraints.value||"").trim();
      const deliverables = cleanLines(els.deliverables.value);

      const qBlock = qs.length ? qs.map(x=>`- ${x}`).join("\n") : "- (none provided)";
      const refBlock = refs.length ? refs.map(x=>`- ${x}`).join("\n") : "- (none provided)";
      const delBlock = deliverables.length ? deliverables.map(x=>`- ${x}`).join("\n") : "- (none provided)";
      const tagsLine = tags ? tags : "(none)";

      const prompt =
`SYSTEM / ROLE
You are an expert KETADATA systems architect + UX strategist. You translate messy notes into a coherent functional map and interface plan optimized for user engagement.

MISSION (ONE LINE)
${summary || "(write a one-line summary first)"}

JOURNALISTIC QUESTIONS (USER INPUT)
${qBlock}

TAGS
${tagsLine}

REFS / SOURCE MATERIAL
${refBlock}

DELIVERABLES (OUTPUT MUST INCLUDE)
${delBlock}

STYLE + FORMAT RULES
${modeDirective(els.mode.value)}
${structureDirective(tog)}
${ketadataToneDirective(tog)}
${citationsDirective(tog)}
${constraints ? ("Additional constraints:\n" + constraints) : ""}

IMPORTANT CONSTRAINTS (DO NOT VIOLATE)
- Do not add regulatory/gating language. No permissioning logic beyond capacity + unit limits.
- Spaces/metaphors must be navigable: elevator goes up AND down; floors can host multiple facilities.
- Keep interface language minimal, label-driven, and tactile.

OUTPUT REQUEST
Generate the response now.`;

      return prompt.replace(/\n{3,}/g, "\n\n").trim();
    }

    function writeOut(){
      const p = buildPrompt();
      els.out.value = p;
      els.chars.textContent = String(p.length);
    }

    // ---- buttons
    document.getElementById("generate").addEventListener("click", writeOut);
    document.getElementById("generate2").addEventListener("click", writeOut);

    document.getElementById("copy").addEventListener("click", ()=>{
      if(!els.out.value.trim()) writeOut();
      copyText(els.out.value);
    });

    document.getElementById("exportJson").addEventListener("click", ()=>{
      const data = {
        mode: els.mode.value,
        toggles: readToggles(),
        summary: els.summary.value,
        questions: cleanLines(els.questions.value),
        tags: els.tags.value,
        refs: cleanLines(els.refs.value),
        constraints: els.constraints.value,
        deliverables: cleanLines(els.deliverables.value),
        generatedAt: new Date().toISOString(),
      };
      copyText(JSON.stringify(data, null, 2));
    });

    document.getElementById("reset").addEventListener("click", ()=>{
      els.mode.value = "analysis";
      els.summary.value = "";
      els.questions.value = "";
      els.tags.value = "";
      els.refs.value = "";
      els.constraints.value = "";
      els.deliverables.value = "";
      writeOut();
    });

    document.getElementById("fillW").addEventListener("click", ()=>{
      els.questions.value =
`WHO is the target user?
WHAT is the core action loop?
WHEN does the system refresh / re-org?
WHERE do key facilities live (floors/zones)?
WHY does the user return daily/weekly?
HOW do capacity + unit limits increase engagement?`;
    });

    document.getElementById("clearQ").addEventListener("click", ()=> els.questions.value="");

    // ---- preset local save/load
    const KEY = "ketadata_prompt_generator_preset_v1";

    function getPreset(){
      return {
        mode: els.mode.value,
        toggles: readToggles(),
        summary: els.summary.value,
        questions: els.questions.value,
        tags: els.tags.value,
        refs: els.refs.value,
        constraints: els.constraints.value,
        deliverables: els.deliverables.value
      };
    }

    function applyPreset(p){
      els.mode.value = p.mode || "analysis";
      // toggles
      for(const k of Object.keys(toggleState)){
        toggleState[k] = !!(p.toggles && p.toggles[k]);
      }
      // update UI pills
      document.querySelectorAll("#toggles .pill").forEach(el=>{
        const k = el.dataset.k;
        el.classList.toggle("on", !!toggleState[k]);
      });

      els.summary.value = p.summary || "";
      els.questions.value = p.questions || "";
      els.tags.value = p.tags || "";
      els.refs.value = p.refs || "";
      els.constraints.value = p.constraints || "";
      els.deliverables.value = p.deliverables || "";
      writeOut();
    }

    document.getElementById("savePreset").addEventListener("click", ()=>{
      localStorage.setItem(KEY, JSON.stringify(getPreset()));
      els.presetStatus.textContent = "SAVED";
    });

    document.getElementById("loadPreset").addEventListener("click", ()=>{
      const raw = localStorage.getItem(KEY);
      if(!raw){ els.presetStatus.textContent = "NONE"; return; }
      try{
        const p = JSON.parse(raw);
        applyPreset(p);
        els.presetStatus.textContent = "LOADED";
      }catch(e){
        els.presetStatus.textContent = "ERROR";
      }
    });

    // ---- hotkey
    document.addEventListener("keydown", (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key === "Enter"){
        e.preventDefault();
        writeOut();
      }
    });

    // init
    writeOut();
    // auto-load preset if exists
    const raw = localStorage.getItem(KEY);
    if(raw){
      try{ applyPreset(JSON.parse(raw)); els.presetStatus.textContent="LOADED"; }
      catch(e){ els.presetStatus.textContent="ERROR"; }
    }
  </script>
</body>
</html>
