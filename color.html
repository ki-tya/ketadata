<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KETADATA — COLOR VAULT</title>

  <style>
    :root{
      /* Core */
      --void:#000000;
      --mind:#ffffff;

      /* Techno / signal */
      --laser:#ffffff;            /* hard white */
      --steel:#666666;            /* link rest */
      --hair:rgba(255,255,255,.12);
      --hair2:rgba(255,255,255,.08);

      /* Reds (aggressive + darkroom) */
      --record:#ff1a1a;           /* vivid signal red (stronger than muted) */
      --darkroom:#4a0000;         /* rich, concentrated, dried-blood-ish */
      --danger:#ff0000;

      /* UV / Violet */
      --uv:#7a00ff;
      --violet:#b000ff;
      --ultraviolet:#5b2cff;

      /* Medical / x-ray-ish */
      --med-green:#00ff66;
      --xray-cyan:#00ffff;
      --shock-magenta:#ff00ff;
      --med-blue:#0088ff;

      --sans: Arial, Helvetica, sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;

      --tile: 128px;
      --gap: 14px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background: var(--void);
      color: var(--mind);
      font-family: var(--sans);
      letter-spacing:.02em;
      overflow-x:hidden;
    }

    /* Top bar */
    .top{
      position: sticky;
      top: 0;
      z-index: 50;
      border-bottom: 1px solid var(--hair);
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(10px);
    }
    .topInner{
      width: min(1320px, 96vw);
      margin: 0 auto;
      padding: 12px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .brand{
      display:flex;
      align-items:baseline;
      gap: 10px;
      white-space:nowrap;
      user-select:none;
    }
    .brand b{
      font-weight: 800;
      letter-spacing: .12em;
      text-transform: uppercase;
      font-size: 12px;
    }
    .slashes{
      font-family: var(--mono);
      letter-spacing: .28em;
      font-weight: 800;
      opacity:.95;
    }
    .meta{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      color: rgba(255,255,255,.66);
      text-transform: uppercase;
    }

    .controls{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }

    .btn{
      appearance:none;
      border: 1px solid var(--hair);
      background: rgba(255,255,255,.02);
      color: rgba(255,255,255,.82);
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .14em;
      text-transform: uppercase;
      padding: 8px 10px;
      cursor:pointer;
      transition: border-color .15s ease, background .15s ease, color .15s ease;
    }
    .btn:hover{
      border-color: rgba(255,255,255,.32);
      background: rgba(255,255,255,.04);
      color: var(--laser);
    }

    .btn.red:hover{ border-color: rgba(255,26,26,.45); background: rgba(255,26,26,.08); color: var(--record); }
    .btn.uv:hover{ border-color: rgba(122,0,255,.5); background: rgba(122,0,255,.10); color: #d8b8ff; }

    .hint{
      width: min(1320px, 96vw);
      margin: 0 auto;
      padding: 12px 10px 0;
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      color: rgba(255,255,255,.58);
      text-transform: uppercase;
      line-height: 1.6;
    }
    .kbd{
      border: 1px solid rgba(255,255,255,.22);
      padding: 2px 6px;
      border-radius: 0px; /* no rounding */
      background: rgba(255,255,255,.02);
      color: rgba(255,255,255,.86);
    }

    /* Layout */
    .wrap{
      width: min(1320px, 96vw);
      margin: 0 auto;
      padding: 14px 10px 40px;
      display:grid;
      grid-template-columns: 1fr 520px;
      gap: 16px;
    }
    @media (max-width: 1120px){
      .wrap{ grid-template-columns: 1fr; }
      .paletteBay{ height:auto; }
    }

    /* Panels (open plan, no rounded edges) */
    .panel{
      border: 1px solid var(--hair);
      background: rgba(255,255,255,.02);
    }
    .panelHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 10px 10px;
      border-bottom: 1px solid var(--hair2);
      background: rgba(0,0,0,.35);
    }
    .panelHead b{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .16em;
      text-transform: uppercase;
    }
    .panelHead .sub{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      color: rgba(255,255,255,.62);
      text-transform: uppercase;
      white-space:nowrap;
    }

    /* Color vault grid */
    .vault{
      padding: 10px;
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(var(--tile), 1fr));
      gap: var(--gap);
      min-height: 520px;
    }

    .swatch{
      border: 1px solid var(--hair);
      background: rgba(0,0,0,.35);
      cursor: grab;
      user-select:none;
      display:flex;
      flex-direction:column;
      min-height: 120px;
    }
    .swatch:active{ cursor: grabbing; }
    .chip{
      height: 74px;
      background: #111;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .label{
      padding: 8px 8px 10px;
      display:flex;
      flex-direction:column;
      gap: 6px;
      min-height: 46px;
    }
    .label .name{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(255,255,255,.86);
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .label .hex{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      color: rgba(255,255,255,.60);
      display:flex;
      gap: 8px;
      align-items:center;
      justify-content:space-between;
    }
    .copy{
      border: 1px solid var(--hair);
      background: transparent;
      color: rgba(255,255,255,.72);
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing:.12em;
      padding: 3px 6px;
      cursor:pointer;
    }
    .copy:hover{ color: var(--laser); border-color: rgba(255,255,255,.30); }

    /* Empty frames (for future inputs) */
    .empty{
      border: 1px dashed rgba(255,255,255,.22);
      background: rgba(255,255,255,.01);
      min-height: 120px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: rgba(255,255,255,.40);
      padding: 10px;
      text-align:center;
    }

    /* Palette Bay (rearrange into palettes) */
    .paletteBay{
      display:flex;
      flex-direction:column;
      height: calc(100vh - 140px);
      position: sticky;
      top: 92px;
    }

    .paletteBody{
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap: 12px;
      overflow:auto;
      min-height: 340px;
    }

    .palette{
      border: 1px solid var(--hair);
      background: rgba(0,0,0,.28);
    }

    .paletteTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px;
      border-bottom: 1px solid var(--hair2);
      background: rgba(0,0,0,.35);
    }
    .paletteTop input{
      width: 100%;
      border: none;
      outline: none;
      background: transparent;
      color: rgba(255,255,255,.90);
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      text-transform: uppercase;
    }
    .paletteTop .count{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      color: rgba(255,255,255,.55);
      white-space:nowrap;
    }

    .dropzone{
      padding: 10px;
      display:grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      min-height: 110px;
    }
    @media (max-width: 1120px){
      .paletteBay{ position: relative; top:auto; height:auto; }
      .dropzone{ grid-template-columns: repeat(8, 1fr); }
    }

    .slot{
      border: 1px dashed rgba(255,255,255,.22);
      background: rgba(255,255,255,.01);
      height: 56px;
      position:relative;
    }
    .slot .mini{
      position:absolute;
      inset: 0;
      border: 1px solid rgba(255,255,255,.10);
      background: #111;
      cursor: grab;
    }
    .slot .mini:active{ cursor: grabbing; }
    .slot .mini span{
      position:absolute;
      left: 6px;
      bottom: 6px;
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing:.10em;
      color: rgba(255,255,255,.75);
      text-transform: uppercase;
      mix-blend-mode: screen;
    }

    /* Links style (requested) */
    .links{
      width: min(1320px, 96vw);
      margin: 0 auto;
      padding: 0 10px 18px;
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .links a{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .14em;
      text-transform: uppercase;
      text-decoration:none;
      color: var(--steel);
      padding: 6px 0;
    }
    .links a:hover{ color: var(--laser); }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      border: 1px solid var(--hair);
      background: rgba(0,0,0,.72);
      color: rgba(255,255,255,.86);
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .12em;
      text-transform: uppercase;
      padding: 10px 12px;
      opacity: 0;
      pointer-events:none;
      transition: opacity .15s ease;
    }
    .toast.on{ opacity: 1; }

    /* Drag feedback */
    .dragGhost{
      outline: 1px solid rgba(255,255,255,.35);
      outline-offset: -1px;
    }
    .over{
      border-color: rgba(255,255,255,.40) !important;
      background: rgba(255,255,255,.03) !important;
    }
  </style>
</head>

<body>
  <header class="top">
    <div class="topInner">
      <div class="brand">
        <b>KETA</b><span class="slashes">///</span><b>DATA</b>
        <span class="meta">COLOR VAULT — DRAG TO BUILD PALETTES</span>
      </div>

      <div class="controls">
        <button class="btn" id="addPalette">ADD PALETTE</button>
        <button class="btn red" id="reset">RESET</button>
        <button class="btn uv" id="export">EXPORT JSON</button>
      </div>
    </div>

    <div class="hint">
      DRAG SWATCHES INTO PALETTE SLOTS. REORDER PALETTES BY DRAGGING THEIR HEADER.<br/>
      <span class="kbd">CLICK</span> COPY HEX — <span class="kbd">SHIFT</span> CLICK COPY NAME+HEX
    </div>

    <nav class="links" aria-label="links">
      <a href="#">[TOP]</a>
      <a href="#">[DIRECTORY]</a>
      <a href="#">[K-WORLD]</a>
      <a href="#">[K-ROOM]</a>
      <a href="#">[LIBRARY]</a>
      <a href="#">[FUND]</a>
      <a href="#">[SHOP]</a>
    </nav>
  </header>

  <div class="wrap">

    <!-- LEFT: COLOR VAULT -->
    <section class="panel">
      <div class="panelHead">
        <b>[KETADATA COLORS]</b>
        <div class="sub">CORE / RED / UV / MED / SIGNAL + EMPTY FRAMES</div>
      </div>

      <div class="vault" id="vault">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- RIGHT: PALETTE BAY -->
    <aside class="panel paletteBay">
      <div class="panelHead">
        <b>[PALETTES]</b>
        <div class="sub">DROP ZONES — OPEN PLAN</div>
      </div>

      <div class="paletteBody" id="paletteBody">
        <!-- Palettes injected by JS -->
      </div>
    </aside>

  </div>

  <div class="toast" id="toast">COPIED</div>

  <script>
    // -----------------------------
    // KETADATA COLORS (seed set)
    // -----------------------------
    const SEED_COLORS = [
      { name:"VOID", hex:"#000000", group:"core" },
      { name:"MIND", hex:"#ffffff", group:"core" },
      { name:"STEEL", hex:"#666666", group:"signal" },
      { name:"HAIR", hex:"rgba(255,255,255,.12)", group:"signal", css:true },
      { name:"HAIR2", hex:"rgba(255,255,255,.08)", group:"signal", css:true },

      { name:"RECORD", hex:"#ff1a1a", group:"red" },
      { name:"DANGER", hex:"#ff0000", group:"red" },
      { name:"DARKROOM", hex:"#4a0000", group:"red" }, // dried-blood-ish

      { name:"UV", hex:"#7a00ff", group:"uv" },
      { name:"VIOLET", hex:"#b000ff", group:"uv" },
      { name:"ULTRAVIOLET", hex:"#5b2cff", group:"uv" },

      { name:"MED-GREEN", hex:"#00ff66", group:"med" },
      { name:"XRAY-CYAN", hex:"#00ffff", group:"med" },
      { name:"SHOCK-MAGENTA", hex:"#ff00ff", group:"med" },
      { name:"MED-BLUE", hex:"#0088ff", group:"med" },
    ];

    // how many empty frames to include in the vault
    const EMPTY_FRAMES = 12;

    const vault = document.getElementById("vault");
    const paletteBody = document.getElementById("paletteBody");
    const toast = document.getElementById("toast");

    let state = {
      palettes: [
        { id: uid(), name: "PALETTE A", slots: Array(12).fill(null) },
        { id: uid(), name: "PALETTE B", slots: Array(12).fill(null) },
      ],
      // store placed items by palette slot references
    };

    // -----------------------------
    // Helpers
    // -----------------------------
    function uid(){ return Math.random().toString(16).slice(2) + Date.now().toString(16); }

    function showToast(msg="COPIED"){
      toast.textContent = msg;
      toast.classList.add("on");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=> toast.classList.remove("on"), 700);
    }

    function copyText(t){
      navigator.clipboard?.writeText(t).then(()=> showToast("COPIED"))
        .catch(()=> showToast("COPY FAILED"));
    }

    function colorStyle(c){
      if(c.css) return c.hex; // rgba()
      return c.hex;
    }

    // -----------------------------
    // Render vault
    // -----------------------------
    function renderVault(){
      vault.innerHTML = "";

      // seeded colors
      SEED_COLORS.forEach((c, idx)=>{
        vault.appendChild(makeSwatch(c, "seed:"+idx));
      });

      // empty frames for future inputs
      for(let i=0;i<EMPTY_FRAMES;i++){
        const el = document.createElement("div");
        el.className = "empty";
        el.textContent = "[EMPTY FRAME]\nDROP OR DEFINE";
        el.dataset.kind = "empty";
        el.addEventListener("dragover", (e)=>{ e.preventDefault(); el.classList.add("over"); });
        el.addEventListener("dragleave", ()=> el.classList.remove("over"));
        el.addEventListener("drop", (e)=>{
          e.preventDefault();
          el.classList.remove("over");
          // If you drop a swatch here, we duplicate it into the vault as a new swatch (editable later).
          const payload = e.dataTransfer.getData("application/json");
          if(!payload) return;
          const data = JSON.parse(payload);
          if(!data || !data.color) return;
          const newColor = { ...data.color, name: data.color.name + " (COPY)" };
          SEED_COLORS.push(newColor);
          renderVault();
        });
        vault.appendChild(el);
      }
    }

    function makeSwatch(color, dragId){
      const sw = document.createElement("div");
      sw.className = "swatch";
      sw.draggable = true;
      sw.dataset.dragId = dragId;

      const chip = document.createElement("div");
      chip.className = "chip";
      chip.style.background = colorStyle(color);

      const label = document.createElement("div");
      label.className = "label";

      const name = document.createElement("div");
      name.className = "name";
      name.textContent = color.name;

      const hexRow = document.createElement("div");
      hexRow.className = "hex";

      const code = document.createElement("span");
      code.textContent = color.hex;

      const btn = document.createElement("button");
      btn.className = "copy";
      btn.textContent = "COPY";
      btn.addEventListener("click", (e)=>{
        e.stopPropagation();
        copyText(color.hex);
      });

      sw.addEventListener("click", (e)=>{
        // Shift-click copies NAME + HEX
        if(e.shiftKey) copyText(`${color.name} ${color.hex}`);
      });

      hexRow.appendChild(code);
      hexRow.appendChild(btn);

      label.appendChild(name);
      label.appendChild(hexRow);

      sw.appendChild(chip);
      sw.appendChild(label);

      sw.addEventListener("dragstart", (e)=>{
        sw.classList.add("dragGhost");
        e.dataTransfer.setData("application/json", JSON.stringify({ type:"swatch", color }));
        e.dataTransfer.effectAllowed = "copyMove";
      });
      sw.addEventListener("dragend", ()=> sw.classList.remove("dragGhost"));

      return sw;
    }

    // -----------------------------
    // Render palettes
    // -----------------------------
    function renderPalettes(){
      paletteBody.innerHTML = "";
      state.palettes.forEach((p, pIndex)=>{
        paletteBody.appendChild(makePalette(p, pIndex));
      });
    }

    function makePalette(p, pIndex){
      const box = document.createElement("section");
      box.className = "palette";
      box.dataset.paletteId = p.id;

      // Palette header (draggable for reordering palettes)
      const top = document.createElement("div");
      top.className = "paletteTop";
      top.draggable = true;

      const input = document.createElement("input");
      input.value = p.name;
      input.setAttribute("maxlength", "40");
      input.addEventListener("input", ()=>{
        p.name = input.value.toUpperCase();
        input.value = p.name;
      });

      const count = document.createElement("div");
      count.className = "count";
      count.textContent = `${p.slots.filter(Boolean).length}/${p.slots.length}`;

      top.appendChild(input);
      top.appendChild(count);

      // Palette drag reorder logic
      top.addEventListener("dragstart", (e)=>{
        top.classList.add("dragGhost");
        e.dataTransfer.setData("text/palette", p.id);
        e.dataTransfer.effectAllowed = "move";
      });
      top.addEventListener("dragend", ()=> top.classList.remove("dragGhost"));

      box.addEventListener("dragover", (e)=>{
        // allow dropping a palette header on another palette box
        if(e.dataTransfer.types.includes("text/palette")) e.preventDefault();
      });
      box.addEventListener("drop", (e)=>{
        const fromId = e.dataTransfer.getData("text/palette");
        if(!fromId) return;
        const toId = p.id;
        if(fromId === toId) return;
        const fromIndex = state.palettes.findIndex(x=>x.id===fromId);
        const toIndex = state.palettes.findIndex(x=>x.id===toId);
        if(fromIndex<0 || toIndex<0) return;
        const [moved] = state.palettes.splice(fromIndex, 1);
        state.palettes.splice(toIndex, 0, moved);
        renderPalettes();
      });

      // Dropzone
      const dz = document.createElement("div");
      dz.className = "dropzone";

      p.slots.forEach((slotColor, slotIndex)=>{
        const slot = document.createElement("div");
        slot.className = "slot";
        slot.dataset.slot = slotIndex;

        slot.addEventListener("dragover", (e)=>{
          e.preventDefault();
          slot.classList.add("over");
        });
        slot.addEventListener("dragleave", ()=> slot.classList.remove("over"));

        slot.addEventListener("drop", (e)=>{
          e.preventDefault();
          slot.classList.remove("over");

          const payload = e.dataTransfer.getData("application/json");
          if(!payload) return;
          const data = JSON.parse(payload);
          if(!data || !data.color) return;

          // Place color into this slot
          p.slots[slotIndex] = data.color;
          renderPalettes();
        });

        if(slotColor){
          const mini = document.createElement("div");
          mini.className = "mini";
          mini.style.background = colorStyle(slotColor);
          mini.draggable = true;

          const tag = document.createElement("span");
          tag.textContent = slotColor.name;

          mini.appendChild(tag);

          // Drag out (to move within palettes by re-dropping)
          mini.addEventListener("dragstart", (e)=>{
            mini.classList.add("dragGhost");
            e.dataTransfer.setData("application/json", JSON.stringify({ type:"swatch", color: slotColor }));
            e.dataTransfer.effectAllowed = "move";
            // remember origin for delete-on-drop-outside
            e.dataTransfer.setData("text/origin", JSON.stringify({ paletteId: p.id, slotIndex }));
          });
          mini.addEventListener("dragend", ()=> mini.classList.remove("dragGhost"));

          // Right-click / double-click to clear
          mini.addEventListener("dblclick", ()=>{
            p.slots[slotIndex] = null;
            renderPalettes();
          });

          slot.appendChild(mini);
        }

        dz.appendChild(slot);
      });

      box.appendChild(top);
      box.appendChild(dz);
      return box;
    }

    // -----------------------------
    // Buttons
    // -----------------------------
    document.getElementById("addPalette").addEventListener("click", ()=>{
      state.palettes.push({ id: uid(), name: `PALETTE ${String.fromCharCode(65+state.palettes.length)}`, slots: Array(12).fill(null) });
      renderPalettes();
    });

    document.getElementById("reset").addEventListener("click", ()=>{
      state.palettes = [
        { id: uid(), name: "PALETTE A", slots: Array(12).fill(null) },
        { id: uid(), name: "PALETTE B", slots: Array(12).fill(null) },
      ];
      renderPalettes();
      showToast("RESET");
    });

    document.getElementById("export").addEventListener("click", ()=>{
      const payload = {
        palettes: state.palettes.map(p=>({
          name: p.name,
          slots: p.slots.map(c => c ? { name:c.name, hex:c.hex } : null)
        })),
        timestamp: new Date().toISOString()
      };
      copyText(JSON.stringify(payload, null, 2));
      showToast("EXPORTED JSON");
    });

    // -----------------------------
    // Init
    // -----------------------------
    renderVault();
    renderPalettes();
  </script>
</body>
</html>
