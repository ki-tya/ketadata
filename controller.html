<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>KETADATA TESTER</title>

<style>
:root{
  --bg1:#050508;
  --bg2:#120000;
  --fg1:#ffffff;
  --fg2:#ff1a1a;

  --angle: 45deg;
  --speed: 12s;

  --nameFont: Arial, Helvetica, sans-serif;
  --uiFont: Arial, Helvetica, sans-serif;
  --sizeScale: 1;
}

/* RESET */
*{ box-sizing:border-box; }
html,body{
  margin:0;
  height:100%;
  background:#000;
  color:#fff;
  font-family:var(--uiFont);
  overflow:hidden;
}

/* BACKGROUND */
.stage{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:
    radial-gradient(
      circle at center,
      var(--bg1),
      var(--bg2)
    );
  animation: rotateBg var(--speed) linear infinite;
}
@keyframes rotateBg{
  0%{ filter:hue-rotate(0deg); }
  100%{ filter:hue-rotate(360deg); }
}

/* WORD */
.word{
  font-family:var(--nameFont);
  font-weight:900;
  text-transform:uppercase;
  white-space:nowrap;
  line-height:0.95;
  letter-spacing:.06em;
  background:linear-gradient(90deg,var(--fg1),var(--fg2));
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  user-select:none;
}

/* TESTER */
.tester{
  position:fixed;
  top:12px;
  left:12px;
  width:320px;
  background:#0a0a0f;
  border:1px solid #222;
  padding:10px;
  font-size:11px;
}

.tester h3{
  margin:0 0 6px 0;
  font-size:11px;
  letter-spacing:.2em;
  text-transform:uppercase;
}

.tester button{
  width:100%;
  background:#000;
  color:#999;
  border:1px solid #333;
  padding:6px;
  cursor:pointer;
  font-family:var(--uiFont);
  font-size:11px;
}
.tester button:hover{ color:#fff; }

.panel{
  margin-top:8px;
  display:none;
}

label{
  display:block;
  margin:6px 0 2px;
  color:#777;
}

input,select{
  width:100%;
  background:#000;
  color:#fff;
  border:1px solid #333;
  padding:4px;
  font-size:11px;
  font-family:var(--uiFont);
}

/* INPUT */
.inputWrap{
  position:fixed;
  bottom:18px;
  left:50%;
  transform:translateX(-50%);
  font-size:11px;
  letter-spacing:.2em;
  text-transform:uppercase;
}
.inputWrap input{
  width:260px;
  text-align:center;
}
</style>
</head>

<body>

<div class="stage">
  <div id="word" class="word">WHAT///EVER</div>
</div>

<!-- USER INPUT -->
<div class="inputWrap">
  <input id="textInput" maxlength="32" placeholder="TYPE" />
</div>

<!-- TESTER -->
<div class="tester">
  <h3>TESTER</h3>
  <button id="toggle">[ OPEN / CLOSE ]</button>

  <div class="panel" id="panel">

    <label>NAME FONT</label>
    <select id="nameFont">
      <option>Arial</option>
      <option>Helvetica Neue</option>
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>Eurostile</option>
    </select>

    <label>UI FONT</label>
    <select id="uiFont">
      <option>Arial</option>
      <option>Inter</option>
      <option>IBM Plex Sans</option>
    </select>

    <label>TEXT SIZE SCALE</label>
    <input id="scale" type="range" min="0.6" max="1.4" step="0.01" value="1"/>

    <label>TEXT COLOR A</label>
    <input id="fg1" type="color" value="#ffffff"/>

    <label>TEXT COLOR B</label>
    <input id="fg2" type="color" value="#ff1a1a"/>

    <label>BG COLOR A</label>
    <input id="bg1" type="color" value="#050508"/>

    <label>BG COLOR B</label>
    <input id="bg2" type="color" value="#120000"/>

    <label>ROTATION SPEED (S)</label>
    <input id="speed" type="range" min="2" max="40" value="12"/>

  </div>
</div>

<script>
const word = document.getElementById("word");
const input = document.getElementById("textInput");

/* AUTOFIT */
function fit(){
  let size = 100;
  word.style.fontSize = size+"px";
  while(word.scrollWidth < window.innerWidth * .98){
    size += 4;
    word.style.fontSize = size+"px";
  }
  while(word.scrollWidth > window.innerWidth * .98){
    size -= 2;
    word.style.fontSize = size+"px";
  }
}
window.addEventListener("resize",fit);
fit();

/* INPUT */
input.addEventListener("input",()=>{
  word.textContent = input.value || "WHATEVER";
  fit();
});

/* TOGGLE */
const panel = document.getElementById("panel");
document.getElementById("toggle").onclick=()=>{
  panel.style.display = panel.style.display==="none" ? "block" : "none";
};

/* CONTROLS */
const set = (id,cb)=>document.getElementById(id).addEventListener("input",cb);

set("nameFont",e=>{
  document.documentElement.style.setProperty("--nameFont",e.target.value);
  fit();
});
set("uiFont",e=>{
  document.documentElement.style.setProperty("--uiFont",e.target.value);
});
set("scale",e=>{
  word.style.transform = `scale(${e.target.value})`;
});
set("fg1",e=>document.documentElement.style.setProperty("--fg1",e.target.value));
set("fg2",e=>document.documentElement.style.setProperty("--fg2",e.target.value));
set("bg1",e=>document.documentElement.style.setProperty("--bg1",e.target.value));
set("bg2",e=>document.documentElement.style.setProperty("--bg2",e.target.value));
set("speed",e=>document.documentElement.style.setProperty("--speed",e.target.value+"s"));

<!-- =========================
KETADATA LIGHT CONTROLLER (1–6)
SPACE: toggle on/off
1–6: select effect
0: stop
========================= -->

<div id="kLight" class="kLight" aria-label="Light Controller">
  <div class="kLightTop">
    <div class="kLightTitle">[STROBE EFFECTS]</div>
    <button id="kLightToggle" class="kBtn">[OPEN]</button>
  </div>

  <div id="kLightPanel" class="kLightPanel" style="display:none;">
    <div class="kRow">
      <button class="kBtn kPreset" data-effect="1">[1 / STROBE]</button>
      <button class="kBtn kPreset" data-effect="2">[2 / EMDR]</button>
      <button class="kBtn kPreset" data-effect="3">[3 / NYAN]</button>
      <button class="kBtn kPreset" data-effect="4">[4 / HEARTBEAT]</button>
      <button class="kBtn kPreset" data-effect="5">[5 / VIOLET]</button>
      <button class="kBtn kPreset" data-effect="6">[6 / PAPARAZZI]</button>
    </div>

    <div class="kRow kMeta">
      <div>ACTIVE: <span id="kActive">NONE</span></div>
      <div>STATE: <span id="kState">OFF</span></div>
      <div><span class="kbd">SPACE</span> toggle · <span class="kbd">0</span> stop · <span class="kbd">1–6</span> select</div>
    </div>

    <div class="kGrid">
      <div class="kBox">
        <div class="kBoxTitle">[GLOBAL]</div>

        <label class="kLabel">MASTER INTENSITY</label>
        <input id="kIntensity" class="kRange" type="range" min="0.2" max="2.5" step="0.01" value="1"/>

        <label class="kLabel">FRAME RATE (MS)</label>
        <input id="kMs" class="kRange" type="range" min="8" max="80" step="1" value="25"/>
        <div class="kHint">Lower = faster. Applied to all effects unless overridden.</div>

        <label class="kLabel">SAFE RESET</label>
        <button id="kReset" class="kBtn kBtnWide">[STOP + RESET]</button>
      </div>

      <div class="kBox">
        <div class="kBoxTitle">[EFFECT TUNING]</div>

        <label class="kLabel">STROBE SPEED (MS)</label>
        <input id="kStrobeMs" class="kRange" type="range" min="20" max="200" step="1" value="50"/>

        <label class="kLabel">PAPARAZZI GAP (FRAMES)</label>
        <input id="kPGap" class="kRange" type="range" min="20" max="120" step="1" value="50"/>

        <label class="kLabel">EMDR STEP (HUE JUMP)</label>
        <input id="kEMDRStep" class="kRange" type="range" min="5" max="60" step="1" value="30"/>

        <div class="kHint">You can add more knobs per effect as you keep feeding codes.</div>
      </div>
    </div>
  </div>
</div>

<style>
  /* bunker UI, no rounding */
  .kLight{
    position:fixed;
    top:12px;
    left:12px;
    width:360px;
    background:#07070b;
    border:1px solid #23232b;
    color:#fff;
    font-family: Arial, Helvetica, sans-serif;
    font-size:11px;
    z-index:999999;
  }
  .kLightTop{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    padding:10px;
    border-bottom:1px solid #23232b;
  }
  .kLightTitle{
    letter-spacing:.22em;
    text-transform:uppercase;
    font-weight:800;
    color:#fff;
  }
  .kBtn{
    background:#000;
    border:1px solid #2f2f39;
    color:#666;
    padding:6px 8px;
    cursor:pointer;
    letter-spacing:.18em;
    text-transform:uppercase;
    font-size:11px;
    font-family: Arial, Helvetica, sans-serif;
  }
  .kBtn:hover{ color:#fff; border-color:#fff; }
  .kBtnWide{ width:100%; padding:8px 10px; }
  .kLightPanel{ padding:10px; }

  .kRow{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
  .kMeta{
    justify-content:space-between;
    color:#aaa;
    letter-spacing:.08em;
    line-height:1.4;
    border:1px solid #1a1a22;
    padding:8px;
    background:#05050a;
  }
  .kbd{
    border:1px solid #333;
    padding:1px 5px;
    color:#fff;
    background:#000;
    letter-spacing:.12em;
  }
  .kGrid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
  }
  @media (max-width: 900px){
    .kLight{ width:92vw; }
    .kGrid{ grid-template-columns:1fr; }
  }
  .kBox{
    border:1px solid #1f1f2a;
    background:#06060c;
    padding:10px;
  }
  .kBoxTitle{
    letter-spacing:.22em;
    text-transform:uppercase;
    font-weight:800;
    margin-bottom:8px;
    color:#fff;
  }
  .kLabel{
    display:block;
    margin:8px 0 4px;
    color:#888;
    letter-spacing:.14em;
    text-transform:uppercase;
  }
  .kRange{
    width:100%;
    margin:0;
    accent-color:#fff; /* keep hard */
  }
  .kHint{
    margin-top:6px;
    color:#666;
    letter-spacing:.06em;
    line-height:1.35;
  }
</style>

<script>
(() => {
  // -------- Controller State --------
  const state = {
    active: 0,          // 1..6
    running: false,
    interval: null,
    count: 0,
    hue: 0,
    pulse: 0,
    intensity: 0,
    flashCount: 0,
    angle: 0,
    radius: 0,
    ms: 25,

    master: 1,
    strobeMs: 50,
    pGap: 50,
    emdrStep: 30,
  };

  // -------- UI Elements --------
  const elToggle = document.getElementById("kLightToggle");
  const elPanel  = document.getElementById("kLightPanel");
  const elActive = document.getElementById("kActive");
  const elState  = document.getElementById("kState");
  const elReset  = document.getElementById("kReset");

  const elMaster = document.getElementById("kIntensity");
  const elMs     = document.getElementById("kMs");
  const elStrobe = document.getElementById("kStrobeMs");
  const elPGap   = document.getElementById("kPGap");
  const elStep   = document.getElementById("kEMDRStep");

  // -------- Helpers --------
  const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
  const bg = (c)=>document.body.style.backgroundColor = c;
  const fx = (f)=>document.body.style.filter = f;

  function hardResetVisuals(){
    bg("black");
    fx("none");
  }

  function stop(){
    if(state.interval) clearInterval(state.interval);
    state.interval = null;
    state.running = false;
    state.count = 0;
    state.hue = 0;
    state.pulse = 0;
    state.intensity = 0;
    state.flashCount = 0;
    state.angle = 0;
    state.radius = 0;
    hardResetVisuals();
    renderStatus();
  }

  function start(){
    if(state.active === 0) return;
    stop(); // ensures single interval
    state.running = true;
    renderStatus();
    runActive();
  }

  function setActive(n){
    state.active = n;
    renderStatus();
    if(state.running) start();
  }

  function renderStatus(){
    const name = ({
      0:"NONE",
      1:"1 / STROBE",
      2:"2 / EMDR",
      3:"3 / NYAN",
      4:"4 / HEARTBEAT",
      5:"5 / VIOLET",
      6:"6 / PAPARAZZI"
    })[state.active] || "UNKNOWN";
    elActive.textContent = name;
    elState.textContent = state.running ? "ON" : "OFF";
  }

  // -------- Effects (compiled from your code) --------
  function runActive(){
    const master = Number(state.master);

    // Effect 1: STROBE (black/white toggle)
    if(state.active === 1){
      state.interval = setInterval(()=>{
        const cur = (document.body.style.backgroundColor || "black");
        bg(cur === "black" ? "white" : "black");
      }, Math.max(10, Number(state.strobeMs)));
      return;
    }

    // Effect 2: EMDR (chromatic pulse)
    if(state.active === 2){
      state.interval = setInterval(()=>{
        state.hue = (state.hue + Number(state.emdrStep)) % 360;
        state.pulse += 0.5 * master;
        const lightness = 50 + Math.sin(state.pulse) * (40 * master);
        bg(`hsl(${state.hue}, 100%, ${clamp(lightness,0,100)}%)`);
      }, state.ms);
      return;
    }

    // Effect 3: NYAN (your “xray” beat sequence)
    if(state.active === 3){
      state.interval = setInterval(()=>{
        state.count++;
        const beat = state.count % 16;

        if (beat === 0 || beat === 1) {
          bg("#ffffff");
          fx(`invert(1) contrast(${3*master}) brightness(${2*master})`);
        } else if (beat === 2) {
          bg("#000000");
          fx(`invert(1) contrast(${2*master})`);
        } else if (beat === 3) {
          bg("#00ff00");
          fx(`contrast(${2*master}) saturate(${3*master})`);
        } else if (beat === 4) {
          bg("#ff00ff");
          fx(`invert(1) hue-rotate(90deg)`);
        } else if (beat === 5 || beat === 6) {
          bg("#00ffff");
          fx(`invert(${0.7*master}) contrast(${2*master})`);
        } else if (beat === 7) {
          bg("#ffffff");
          fx(`invert(1) brightness(${3*master})`);
        } else if (beat === 8) {
          bg("#000000");
          fx(`invert(1) contrast(${3*master})`);
        } else if (beat === 9 || beat === 10) {
          bg("#00ff00");
          fx(`saturate(${5*master}) contrast(${2*master})`);
        } else if (beat === 11) {
          bg("#ff00ff");
          fx(`invert(1) saturate(${3*master})`);
        } else {
          bg("#0088ff");
          fx(`contrast(${1.5*master}) brightness(${1.2*master})`);
        }
      }, state.ms);
      return;
    }

    // Effect 4: HEARTBEAT (your red/black pulse)
    if(state.active === 4){
      state.interval = setInterval(()=>{
        state.intensity += 0.08 * master;
        state.flashCount++;

        const red = Math.abs(Math.sin(state.intensity)) * 255;
        const pulse = Math.abs(Math.sin(state.intensity * 0.5));
        const contrast = 2 + pulse * 2 * master;
        const saturation = 4 + pulse * 2 * master;

        if (state.flashCount % 8 === 0) {
          bg("#000000");
          fx(`brightness(${3*master}) contrast(${3*master})`);
        } else {
          bg(`rgb(${red|0},0,0)`);
          const bump = (state.flashCount % 8 === 1) ? 1 : 0;
          fx(`contrast(${contrast + bump}) saturate(${saturation + bump*2}) brightness(${(1.2 + pulse*0.5)*master})`);
        }
      }, 20);
      return;
    }

    // Effect 5: VIOLET (ultraviolet aura spiral)
    if(state.active === 5){
      state.interval = setInterval(()=>{
        state.angle += 15 * master;
        state.radius = (state.radius + 2 * master) % 100;

        const hue = 260 + Math.sin(state.angle * 0.1) * 40;
        const saturation = 80 + Math.cos(state.angle * 0.05) * 20;
        const lightness = 30 + Math.sin(state.radius * 0.1) * 30;

        const spiralBrightness = 1 + Math.abs(Math.sin(state.angle * 0.05)) * 0.8 * master;
        const spiralContrast = 1.5 + Math.abs(Math.cos(state.angle * 0.08)) * 1 * master;

        bg(`hsl(${hue}, ${clamp(saturation,0,100)}%, ${clamp(lightness,0,100)}%)`);
        fx(`contrast(${spiralContrast}) saturate(${2*master}) brightness(${spiralBrightness}) hue-rotate(${state.angle * 0.5}deg)`);
      }, 25);
      return;
    }

    // Effect 6: PAPARAZZI (double flash)
    if(state.active === 6){
      state.interval = setInterval(()=>{
        state.count++;
        const gap = Math.max(10, Number(state.pGap));

        if (state.count % gap === 0) {
          bg("#ffffff");
          fx(`brightness(${5*master}) contrast(${5*master})`);
        } else if (state.count % gap === 1) {
          bg("#000000");
          fx("none");
        } else if (state.count % gap === 2) {
          bg("#ffffff");
          fx(`brightness(${5*master}) contrast(${5*master})`);
        } else {
          bg("#000000");
          fx("none");
        }
      }, 30);
      return;
    }
  }

  // -------- Panel Toggle --------
  elToggle.addEventListener("click",()=>{
    const open = elPanel.style.display !== "none";
    elPanel.style.display = open ? "none" : "block";
    elToggle.textContent = open ? "[OPEN]" : "[CLOSE]";
  });

  // -------- Preset Buttons --------
  document.querySelectorAll(".kPreset").forEach(btn=>{
    btn.addEventListener("click",()=>{
      setActive(Number(btn.dataset.effect));
      start();
    });
  });

  // -------- Sliders --------
  elMaster.addEventListener("input",(e)=>{ state.master = Number(e.target.value); if(state.running) start(); });
  elMs.addEventListener("input",(e)=>{ state.ms = Number(e.target.value); if(state.running) start(); });
  elStrobe.addEventListener("input",(e)=>{ state.strobeMs = Number(e.target.value); if(state.running && state.active===1) start(); });
  elPGap.addEventListener("input",(e)=>{ state.pGap = Number(e.target.value); if(state.running && state.active===6) start(); });
  elStep.addEventListener("input",(e)=>{ state.emdrStep = Number(e.target.value); if(state.running && state.active===2) start(); });

  // -------- Reset --------
  elReset.addEventListener("click", stop);

  // -------- Keyboard Controls --------
  document.addEventListener("keydown",(event)=>{
    // SPACE: toggle
    if(event.key === " " || event.code === "Space"){
      event.preventDefault();
      if(state.running) stop();
      else start();
      return;
    }

    // 0: stop
    if(event.key === "0"){
      stop();
      return;
    }

    // 1–6: select + start
    if(event.key >= "1" && event.key <= "6"){
      setActive(Number(event.key));
      start();
      return;
    }
  });

  // Init
  state.ms = Number(elMs.value);
  state.master = Number(elMaster.value);
  state.strobeMs = Number(elStrobe.value);
  state.pGap = Number(elPGap.value);
  state.emdrStep = Number(elStep.value);
  renderStatus();
  hardResetVisuals();
})();

</script>

</body>
</html>
