<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KETADATA â€” Router</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #ffffff;
    color: #000000;
    font-family: Arial, Helvetica, sans-serif;
    overflow: hidden;
  }

  #canvas {
    position: relative;
    width: 100vw;
    height: 100vh;
  }

  .module {
    position: absolute;
    width: 200px;
    min-height: 80px;
    border: 1px solid #000;
    background: #fff;
    padding: 8px;
    box-sizing: border-box;
    resize: both;
    overflow: auto;
    cursor: move;
  }

  .title {
    font-size: 14px;
    font-weight: bold;
    outline: none;
  }

  .link {
    font-size: 12px;
    opacity: 0.8;
    outline: none;
    margin-top: 6px;
    display: block;
    word-break: break-all;
  }

  .link a {
    color: #000;
    text-decoration: underline;
  }

  .add {
    position: fixed;
    bottom: 12px;
    right: 12px;
    border: 1px solid #000;
    background: #fff;
    padding: 6px 10px;
    cursor: pointer;
    font-size: 12px;
  }
</style>
</head>

<body>
<div id="canvas"></div>
<div class="add" onclick="addModule()">ADD</div>

<script>
  const canvas = document.getElementById('canvas');
  let modules = JSON.parse(localStorage.getItem('router-modules') || '[]');

  function save() {
    localStorage.setItem('router-modules', JSON.stringify(modules));
  }

  function addModule(data = {}) {
    const mod = {
      id: Date.now(),
      x: 40,
      y: 40,
      w: 200,
      h: 100,
      title: data.title || 'CHANNEL',
      link: data.link || ''
    };
    modules.push(mod);
    render();
    save();
  }

  function render() {
    canvas.innerHTML = '';
    modules.forEach(mod => {
      const el = document.createElement('div');
      el.className = 'module';
      el.style.left = mod.x + 'px';
      el.style.top = mod.y + 'px';
      el.style.width = mod.w + 'px';
      el.style.height = mod.h + 'px';

      const title = document.createElement('div');
      title.className = 'title';
      title.contentEditable = true;
      title.innerText = mod.title;
      title.oninput = () => {
        mod.title = title.innerText;
        save();
      };

      const link = document.createElement('div');
      link.className = 'link';
      link.contentEditable = true;
      link.innerText = mod.link;
      link.oninput = () => {
        mod.link = link.innerText;
        save();
      };

      if (mod.link) {
        const a = document.createElement('a');
        a.href = mod.link;
        a.target = '_blank';
        a.innerText = mod.link;
        link.innerHTML = '';
        link.appendChild(a);
      }

      el.appendChild(title);
      el.appendChild(link);
      canvas.appendChild(el);

      // Drag logic
      let offsetX, offsetY;
      el.onmousedown = e => {
        offsetX = e.clientX - el.offsetLeft;
        offsetY = e.clientY - el.offsetTop;

        document.onmousemove = e => {
          mod.x = e.clientX - offsetX;
          mod.y = e.clientY - offsetY;
          el.style.left = mod.x + 'px';
          el.style.top = mod.y + 'px';
        };

        document.onmouseup = () => {
          document.onmousemove = null;
          document.onmouseup = null;
          mod.w = el.offsetWidth;
          mod.h = el.offsetHeight;
          save();
        };
      };
    });
  }

  render();
</script>
</body>
</html>
