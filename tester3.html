<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KETADATA // STUDIO</title>

  <!-- =========================================================
  AE ▸ KETADATA [STUDIO] LANDING + DIRECTORY (BRUTAL / CLEAN)
  EE ▸ MOVING GRADIENT FIELD (CONTROLLED)
  WB ▸ STATE + KETA_NOTE (LOCALSTORAGE)
  ========================================================= -->

  <style>
    :root{
      /* DEFAULT: MOVING MONOCHROME-LEANING FIELD (can be tinted) */
      --bg1:#000000;
      --bg2:#151515;
      --bg3:#2a2a2a;
      --bg4:#0a0a0a;

      --motionSpeed: 0.55;           /* 0..1 */
      --angle: 145deg;

      --aX: 18%; --aY: 20%;
      --bX: 78%; --bY: 28%;
      --cX: 28%; --cY: 86%;
      --dX: 86%; --dY: 82%;

      --aA: 0.18;
      --bA: 0.14;
      --cA: 0.12;
      --dA: 0.10;

      --txt:#ffffff;
      --uiFont: Arial, Helvetica, sans-serif;
      --uiSize: 12px;

      --linkRest:#7a7a7a;
      --linkHover:#ffffff;

      /* TEXT SIZE CONTROLS */
      --titleMaxPx: 180px;   /* clamp max */
      --linkSizePx: 11px;

      /* LANDING POSITION */
      --titleX: 50vw;             /* centered */
      --titleY: 55vh;             /* slightly above mid */
      --titleMaxWidth: calc(100vw - 88px);

      /* UI */
      --line: rgba(255,255,255,0.14);
      --line2: rgba(255,255,255,0.24);
      --panelBg: rgba(0,0,0,0.55);
      --panelBlur: 8px;
      --radius: 0px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    html{ scroll-behavior:auto; }
    body{
      margin:0;
      font-family: var(--uiFont);
      font-size: var(--uiSize);
      color: var(--txt);
      background:#000;
      overflow-x:hidden;

      /* SNAP */
      scroll-snap-type: y mandatory;
      scroll-snap-stop: always;
    }
    section{
      height:100vh;
      scroll-snap-align:start;
      position:relative;
      z-index: 30;
      overflow:hidden;
    }

    /* ===== BG LAYER ===== */
    #bgLayer{
      position:fixed;
      inset:0;
      z-index: 1;
      pointer-events:none;
      background:
        radial-gradient(1100px 680px at var(--aX) var(--aY), rgba(255,255,255,var(--aA)), transparent 70%),
        radial-gradient(900px 620px at var(--bX) var(--bY), rgba(255,255,255,var(--bA)), transparent 72%),
        radial-gradient(1000px 720px at var(--cX) var(--cY), rgba(255,255,255,var(--cA)), transparent 74%),
        radial-gradient(900px 640px at var(--dX) var(--dY), rgba(255,255,255,var(--dA)), transparent 72%),
        linear-gradient(var(--angle), var(--bg1), var(--bg2), var(--bg3), var(--bg4));
      background-size: auto, auto, auto, auto, 200% 200%;
      filter: contrast(1.05);
      opacity: 1;
      transform: translate3d(0,0,0);
    }

    @keyframes drift{
      0%   { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 50%; }
      50%  { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 100% 50%; }
      100% { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 50%; }
    }
    #bgLayer.moving{
      animation: drift calc(14s / max(0.12, var(--motionSpeed))) linear infinite;
    }

    /* ===== HUD PANEL ===== */
    .hud{
      position:fixed;
      left:16px;
      top:16px;
      z-index:40;
      width: 268px;
      border:1px solid var(--line2);
      background: var(--panelBg);
      backdrop-filter: blur(var(--panelBlur));
      border-radius: var(--radius);
      padding: 10px 10px 12px;
      user-select:none;
    }
    .hudHead{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding-bottom:8px;
      border-bottom:1px solid var(--line);
      margin-bottom:10px;
    }
    .lbl{
      display:block;
      font-size:11px;
      letter-spacing:.16em;
      text-transform:uppercase;
      color: rgba(255,255,255,.72);
      margin:10px 0 6px;
    }
    .mini2{
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.46);
      margin-bottom:6px;
    }
    .twoCol{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-items:end;
    }
    input[type="color"]{
      width:100%;
      height:28px;
      border:1px solid var(--line2);
      background:#000;
      padding:0;
      border-radius: var(--radius);
    }
    input[type="range"]{ width:100%; }
    input[type="number"]{
      width:100%;
      height:28px;
      border:1px solid var(--line2);
      background:#000;
      color:#fff;
      padding:0 8px;
      outline:none;
      border-radius: var(--radius);
      font-family: var(--uiFont);
    }

    .btn{
      height:28px;
      padding:0 10px;
      border:1px solid rgba(255,255,255,0.24);
      background: rgba(0,0,0,0.45);
      color: rgba(255,255,255,0.86);
      font-size:11px;
      letter-spacing:.16em;
      text-transform:uppercase;
      cursor:pointer;
      border-radius: var(--radius);
    }
    .btn:hover{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.42); }
    .btn.on{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.52); }

    /* KETA_NOTE ICON: WHITE SQUARE ONLY */
    .noteIconBtn{
      width:28px;height:28px;
      display:inline-flex;align-items:center;justify-content:center;
      border:1px solid rgba(255,255,255,0.24);
      background: rgba(0,0,0,0.45);
      cursor:pointer;
      border-radius: var(--radius);
    }
    .noteIconBtn:hover{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.42); }
    .ketaSquare{ width:10px;height:10px;background:#fff;display:inline-block; }

    /* ===== KETA_NOTE (collapsed by default) ===== */
    .ketaNote{
      position:fixed;
      right:16px;
      bottom:16px;
      z-index:40;
      width: min(520px, calc(100vw - 32px));
      border:1px solid rgba(255,255,255,0.58);
      background: rgba(0,0,0,0.70);
      backdrop-filter: blur(8px);
      border-radius: 0;
      display:none; /* default collapsed */
    }
    .ketaHead{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 10px;
      border-bottom:1px solid rgba(255,255,255,0.18);
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      user-select:none;
    }
    .hbtn{
      height:22px;
      padding:0 8px;
      border:1px solid rgba(255,255,255,0.24);
      background: rgba(0,0,0,0.35);
      color:#fff;
      cursor:pointer;
      font-size:11px;
      letter-spacing:.12em;
      border-radius:0;
    }
    .ketaBody{
      display:grid;
      grid-template-columns: 26px 1fr;
      gap:10px;
      padding:10px;
      align-items:stretch;
    }
    .ketaIconCol{ display:flex; align-items:flex-start; justify-content:center; padding-top:4px; }
    textarea{
      width:100%;
      height: 180px;
      resize:vertical;
      background:#000;
      color:#fff;
      border:1px solid rgba(255,255,255,0.16);
      outline:none;
      padding:10px;
      font-family: var(--uiFont);
      font-size: 12px;
      line-height: 1.3;
      border-radius:0;
    }

    /* ===== LANDING (CENTERED TITLE; DIRECTORY LINK LEFT UNDER TITLE) ===== */
    .landing{ position:relative; }
    .landingTitleWrap{
      position:absolute;
      left: var(--titleX);
      top: var(--titleY);
      transform: translate(-50%, -50%);
      text-align:center;
      width: var(--titleMaxWidth);
      max-width: var(--titleMaxWidth);
    }
    .title{
      margin:0;
      font-weight:900;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size: clamp(56px, 8.8vw, var(--titleMaxPx));
      line-height:.92;
      white-space:nowrap; /* one line */
      user-select:none;
      text-shadow: 0 0 30px rgba(255,255,255,.06);
      max-width: 100%;
      overflow:hidden;
      text-overflow: clip;
    }

    /* THIS IS THE CHANGE YOU ASKED FOR:
       - Directory is a LINK
       - It sits under title
       - It is aligned LEFT (within the title wrap bounds) */
    .sub{
      margin-top: 12px;
      display:block;
      width:100%;
      text-align:left; /* left aligned */
      font-size: 11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.35);
      font-weight:900;
      text-decoration:none;
    }
    .sub:hover{ color: rgba(255,255,255,.85); }

    /* ===== DIRECTORY ===== */
    .directory{
      display:flex;
      align-items:stretch;
      justify-content:center;
      padding: 84px 22px 72px;
    }
    .dirBox{
      width: min(1100px, 100%);
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.46);
      backdrop-filter: blur(8px);
      padding: 16px 16px 10px;
    }
    .dirHead{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding: 6px 0 12px;
      border-bottom: 1px solid rgba(255,255,255,0.12);
      margin-bottom: 12px;
    }
    .dirHead .t{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.86);
      font-weight:900;
    }
    .dirHead .mini{
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.46);
    }
    .dirGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
      padding-bottom: 6px;
    }
    .group{
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.35);
      padding: 12px;
    }
    .groupTitle{
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.62);
      margin-bottom: 10px;
      font-weight:800;
    }
    .links{
      display:flex;
      flex-wrap:wrap;
      gap: 10px 14px;
      align-items:center;
    }
    .links a{
      font-size: var(--linkSizePx);
      letter-spacing:.14em;
      text-transform:uppercase;
      color: var(--linkRest);
      text-decoration:none;
      border-bottom: 1px solid rgba(255,255,255,0.0);
      padding-bottom: 2px;
    }
    .links a:hover{
      color: var(--linkHover);
      border-bottom-color: rgba(255,255,255,0.28);
    }

    /* hint */
    .hint{
      position:fixed;
      left:16px;
      bottom:16px;
      z-index:40;
      font-size:10px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(255,255,255,0.38);
      user-select:none;
    }
    .kbd{
      padding:2px 6px;
      border:1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.35);
      margin-right:6px;
    }
  </style>
</head>

<body>
  <div id="bgLayer" class="moving" aria-hidden="true"></div>

  <!-- HUD -->
  <div class="hud" id="hud">
    <div class="hudHead">
      <div style="display:flex; gap:8px; align-items:center">
        <button class="noteIconBtn" id="btnNote" type="button" title="KETA_NOTE (SHIFT+N toggles note too)">
          <span class="ketaSquare"></span>
        </button>
        <div style="font-size:11px; letter-spacing:.16em; text-transform:uppercase; color:rgba(255,255,255,.78); font-weight:900">
          STUDIO CONTROLS
        </div>
      </div>
      <button class="btn" id="btnMotion" type="button" title="Toggle motion (Space)"><span id="motionLbl">MOTION: ON</span></button>
    </div>

    <span class="lbl">FIELD</span>
    <div class="twoCol">
      <div>
        <div class="mini2">BG 1</div>
        <input id="bg1" type="color" value="#000000" />
      </div>
      <div>
        <div class="mini2">BG 2</div>
        <input id="bg2" type="color" value="#151515" />
      </div>
    </div>
    <div class="twoCol" style="margin-top:8px;">
      <div>
        <div class="mini2">BG 3</div>
        <input id="bg3" type="color" value="#2a2a2a" />
      </div>
      <div>
        <div class="mini2">BG 4</div>
        <input id="bg4" type="color" value="#0a0a0a" />
      </div>
    </div>

    <span class="lbl">ANGLE</span>
    <input id="angle" type="range" min="0" max="360" step="1" value="145" />

    <span class="lbl">TEXT</span>
    <div class="twoCol">
      <div>
        <div class="mini2">COLOR</div>
        <input id="txt" type="color" value="#ffffff" />
      </div>
      <div>
        <div class="mini2">UI SIZE</div>
        <input id="uiSize" type="number" min="10" max="18" step="1" value="12" />
      </div>
    </div>

    <!-- TEXT SIZE CONTROLS -->
    <div class="twoCol" style="margin-top:8px;">
      <div>
        <div class="mini2">TITLE SIZE</div>
        <input id="titleMax" type="range" min="120" max="260" step="1" value="180" />
      </div>
      <div>
        <div class="mini2">LINK SIZE</div>
        <input id="linkSize" type="range" min="10" max="18" step="1" value="11" />
      </div>
    </div>

    <span class="lbl">SPEED</span>
    <input id="speed" type="range" min="0" max="1" step="0.01" value="0.55" />
  </div>

  <!-- GLOBAL KETA_NOTE -->
  <div class="ketaNote" id="ketaNote">
    <div class="ketaHead" id="ketaHead">
      <div>KETA_NOTE</div>
      <button class="hbtn" id="btnHideNote" type="button">-</button>
    </div>
    <div class="ketaBody">
      <div class="ketaIconCol"><span class="ketaSquare"></span></div>
      <textarea id="ketaText" placeholder="GLOBAL NOTE" spellcheck="false"></textarea>
    </div>
  </div>

  <!-- LANDING -->
  <section class="landing" id="top">
    <div class="landingTitleWrap">
      <h1 class="title">KETADATA [STUDIO]</h1>
      <!-- DIRECTORY LINK: UNDER TITLE, ALIGNED LEFT -->
      <a class="sub" href="#directory">[DIRECTORY]</a>
    </div>
  </section>

  <!-- DIRECTORY -->
  <section class="directory" id="directory">
    <div class="dirBox">
      <div class="dirHead">
        <div class="t">STUDIO DIRECTORY</div>
        <div class="mini">LINKS ONLY</div>
      </div>
      <div class="dirGrid" id="dirGrid"></div>
    </div>
  </section>

  <div class="hint">
    <span class="kbd">SPACE</span> MOTION
    <span class="kbd">SHIFT+I</span> INVERT
    <span class="kbd">SHIFT+N</span> NOTE
  </div>

  <script>
    /* =========================================================
       WB ▸ STATE + NOTE
    ========================================================= */

    const FILE_ID = "KETADATA_STUDIO";
    const ROOM_ID = "STUDIO";
    const VERSION_ID = "studio.v7_title_one_line_dir_left";
    const STORAGE_KEY = `KDT::STATE::${FILE_ID}::${ROOM_ID}::${VERSION_ID}`;
    const GLOBAL_KETA_NOTE_KEY = "KDT_GLOBAL_KETA_NOTE_V1";

    const DIRECTORY = [
      { group:"INTERFACE DESIGN", items:[
        ["[CONTROLLER1.HTML]","controller1.html"],
        ["[COLOR1.HTML]","color1.html"],
        ["[COLOR3.HTML]","color3.html"],
        ["[FONT.HTML]","font.html"],
        ["[PROMPT.HTML]","prompt.html"],
        ["[REF.HTML]","ref.html"]
      ]},
      { group:"MOOD-BOARDS", items:[
        ["[STUDIO.HTML]","studio.html"],
        ["[BOARD3.HTML]","board3.html"]
      ]},
      { group:"DATA PRODUCTION", items:[
        ["[EDITOR.HTML]","editor.html"],
        ["[EXPORTER.HTML]","exporter.html"]
      ]},
      { group:"VARIANTS", items:[
        ["[DARKROOM.HTML]","darkroom.html"],
        ["[CONTROLLER2.HTML]","controller2.html"]
      ]}
    ];

    const DEFAULT = {
      ui:{ invert:false, motionOn:true, noteVisible:false },
      motion:{ speed:0.55 },
      colors:{ bg1:"#000000", bg2:"#151515", bg3:"#2a2a2a", bg4:"#0a0a0a", angle:145, txt:"#ffffff", uiSize:12 },
      type:{ titleMax:180, linkSize:11 }
    };

    const $ = (id)=>document.getElementById(id);
    const clamp=(n,a,b)=>Math.max(a,Math.min(b,n));

    function loadState(){
      try{ const raw = localStorage.getItem(STORAGE_KEY); return raw ? JSON.parse(raw) : null; }
      catch(e){ return null; }
    }
    function mergeDefault(s){
      const out = structuredClone(DEFAULT);
      s = s || {};
      out.ui = Object.assign(structuredClone(DEFAULT.ui), s.ui||{});
      out.motion = Object.assign(structuredClone(DEFAULT.motion), s.motion||{});
      out.colors = Object.assign(structuredClone(DEFAULT.colors), s.colors||{});
      out.type = Object.assign(structuredClone(DEFAULT.type), s.type||{});
      return out;
    }
    let STATE = mergeDefault(loadState());

    function persist(){
      try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(STATE)); }catch(e){}
    }

    function loadGlobalNote(){
      try{ return localStorage.getItem(GLOBAL_KETA_NOTE_KEY) || ""; }catch(e){ return ""; }
    }
    function saveGlobalNote(v){
      try{ localStorage.setItem(GLOBAL_KETA_NOTE_KEY, String(v||"")); }catch(e){}
    }

    /* =========================================================
       EE ▸ APPLY
    ========================================================= */
    function applyCssVars(){
      const r = document.documentElement.style;
      r.setProperty("--bg1", STATE.colors.bg1);
      r.setProperty("--bg2", STATE.colors.bg2);
      r.setProperty("--bg3", STATE.colors.bg3);
      r.setProperty("--bg4", STATE.colors.bg4);
      r.setProperty("--angle", `${STATE.colors.angle}deg`);
      r.setProperty("--txt", STATE.colors.txt);
      r.setProperty("--uiSize", `${STATE.colors.uiSize}px`);
      r.setProperty("--motionSpeed", STATE.motion.speed);

      r.setProperty("--titleMaxPx", `${STATE.type.titleMax}px`);
      r.setProperty("--linkSizePx", `${STATE.type.linkSize}px`);

      document.body.style.color = STATE.colors.txt;
      $("bgLayer").classList.toggle("moving", !!STATE.ui.motionOn);

      document.documentElement.style.filter = STATE.ui.invert ? "invert(1)" : "none";

      $("motionLbl").textContent = STATE.ui.motionOn ? "MOTION: ON" : "MOTION: OFF";
      $("btnMotion").classList.toggle("on", !!STATE.ui.motionOn);

      $("ketaNote").style.display = STATE.ui.noteVisible ? "block" : "none";
    }

    function bindUi(){
      // inputs
      $("bg1").addEventListener("input", e=>{ STATE.colors.bg1 = e.target.value; applyCssVars(); persist(); });
      $("bg2").addEventListener("input", e=>{ STATE.colors.bg2 = e.target.value; applyCssVars(); persist(); });
      $("bg3").addEventListener("input", e=>{ STATE.colors.bg3 = e.target.value; applyCssVars(); persist(); });
      $("bg4").addEventListener("input", e=>{ STATE.colors.bg4 = e.target.value; applyCssVars(); persist(); });

      $("angle").addEventListener("input", e=>{ STATE.colors.angle = +e.target.value; applyCssVars(); persist(); });
      $("txt").addEventListener("input", e=>{ STATE.colors.txt = e.target.value; applyCssVars(); persist(); });
      $("uiSize").addEventListener("input", e=>{ STATE.colors.uiSize = clamp(+e.target.value||12,10,18); applyCssVars(); persist(); });

      $("titleMax").addEventListener("input", e=>{ STATE.type.titleMax = +e.target.value; applyCssVars(); persist(); });
      $("linkSize").addEventListener("input", e=>{ STATE.type.linkSize = +e.target.value; applyCssVars(); persist(); });

      $("speed").addEventListener("input", e=>{ STATE.motion.speed = +e.target.value; applyCssVars(); persist(); });

      // motion toggle
      const toggleMotion = ()=>{
        STATE.ui.motionOn = !STATE.ui.motionOn;
        applyCssVars(); persist();
      };
      $("btnMotion").addEventListener("click", toggleMotion);

      // note
      const toggleNote = ()=>{
        STATE.ui.noteVisible = !STATE.ui.noteVisible;
        applyCssVars(); persist();
        if(STATE.ui.noteVisible) $("ketaText").focus();
      };
      $("btnNote").addEventListener("click", toggleNote);
      $("btnHideNote").addEventListener("click", toggleNote);

      $("ketaText").value = loadGlobalNote();
      $("ketaText").addEventListener("input", e=> saveGlobalNote(e.target.value));
    }

    function renderDirectory(){
      const root = $("dirGrid");
      root.innerHTML = "";
      DIRECTORY.forEach(g=>{
        const box = document.createElement("div");
        box.className = "group";
        const t = document.createElement("div");
        t.className = "groupTitle";
        t.textContent = g.group;
        box.appendChild(t);

        const links = document.createElement("div");
        links.className = "links";
        g.items.forEach(([label,url])=>{
          const a = document.createElement("a");
          a.href = url;
          a.textContent = label;
          a.addEventListener("click", ()=>{ /* stay simple; no state mutation */ });
          links.appendChild(a);
        });
        box.appendChild(links);
        root.appendChild(box);
      });
    }

    /* =========================================================
       HOTKEYS (ONLY WHAT YOU WANT HERE)
       - SHIFT+I invert
       - SPACE motion (studio page)
       - SHIFT+N note
    ========================================================= */
    document.addEventListener("keydown", (e)=>{
      const k = e.key.toLowerCase();
      if(e.shiftKey && k === "i"){ e.preventDefault(); STATE.ui.invert = !STATE.ui.invert; applyCssVars(); persist(); return; }
      if(e.shiftKey && k === "n"){ e.preventDefault(); STATE.ui.noteVisible = !STATE.ui.noteVisible; applyCssVars(); persist(); return; }
      if(!e.shiftKey && k === " "){ e.preventDefault(); STATE.ui.motionOn = !STATE.ui.motionOn; applyCssVars(); persist(); return; }
    }, {passive:false});

    // init
    (function init(){
      // sync UI fields from state
      $("bg1").value = STATE.colors.bg1;
      $("bg2").value = STATE.colors.bg2;
      $("bg3").value = STATE.colors.bg3;
      $("bg4").value = STATE.colors.bg4;
      $("angle").value = STATE.colors.angle;
      $("txt").value = STATE.colors.txt;
      $("uiSize").value = STATE.colors.uiSize;

      $("titleMax").value = STATE.type.titleMax;
      $("linkSize").value = STATE.type.linkSize;

      $("speed").value = STATE.motion.speed;

      renderDirectory();
      bindUi();
      applyCssVars();
      persist();
    })();
  </script>

  <!-- =========================================================
  WB + AE + EE ▸ SERIALIZATION STAMP (REQUIRED)
  AE/EE/WB + FILE_ID/ROOM_ID/VERSION/UPDATED_AT/CHANGELOG
  =========================================================
  AE: landing title one-line; directory link under title left-aligned; sizes controllable
  EE: mono moving gradient field, speed + angle
  WB: localStorage state + global KETA_NOTE
  FILE_ID: KETADATA_STUDIO
  ROOM_ID: STUDIO
  VERSION: studio.v7_title_one_line_dir_left
  UPDATED_AT: 2025-12-27T00:00:00-05:00
  CHANGELOG:
  - Title forced single-line, centered
  - Directory link under title, aligned left
  - Title size + link size controls preserved
  - KETA_NOTE collapsed by default
  ========================================================= -->
</body>
</html>
