<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>k-desktop</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #6b6b6b; height: 100vh; overflow: hidden; }
        .menu-bar { background: rgba(40, 40, 40, 0.95); backdrop-filter: blur(20px); height: 24px; display: flex; align-items: center; padding: 0 12px; color: white; font-size: 13px; z-index: 5000; border-bottom: 1px solid rgba(0, 0, 0, 0.3); position: relative; }
        .menu-bar-left { display: flex; gap: 20px; flex: 1; }
        .menu-bar-right { display: flex; gap: 12px; font-size: 12px; }
        .menu-item { cursor: pointer; padding: 2px 8px; transition: background 0.2s; }
        .menu-item:hover { background: rgba(255, 255, 255, 0.1); border-radius: 3px; }
        .menu-item.word-change { font-weight: 500; }
        .desktop { height: calc(100vh - 24px); position: relative; padding: 20px; }
        .folder, .drive { width: 100px; text-align: center; cursor: pointer; position: absolute; user-select: none; }
        .folder-icon { width: 70px; height: 60px; margin: 0 auto 5px; background: #1a1a1a; position: relative; border-radius: 4px; }
        .folder-icon::before { content: ''; position: absolute; top: -8px; left: 0; width: 30px; height: 12px; background: #1a1a1a; border-radius: 4px 4px 0 0; }
        .folder-icon::after { content: ''; position: absolute; inset: 0; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.2) 2px, rgba(0,0,0,0.2) 4px), repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0,0,0,0.2) 2px, rgba(0,0,0,0.2) 4px); }
        .folder-name { color: white; font-size: 12px; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8); word-wrap: break-word; padding: 0 5px; }
        .folder:hover .folder-icon, .folder:hover .folder-icon::before { background: #2a2a2a; }
        .drive-icon { width: 70px; height: 60px; margin: 0 auto 5px; background: linear-gradient(180deg, #e8e8e8 0%, #d0d0d0 100%); position: relative; border-radius: 4px; border: 1px solid #999; box-shadow: inset 0 1px 2px rgba(255,255,255,0.5); }
        .drive-icon::after { content: ''; position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 30px; height: 3px; background: #666; border-radius: 1px; }
        .drive:hover .drive-icon { background: linear-gradient(180deg, #f0f0f0 0%, #d8d8d8 100%); }
        .preview-overlay, .content-preview-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; display: none; }
        .preview-overlay.active, .content-preview-overlay.active { display: block; }
        .content-preview-overlay { z-index: 3000; pointer-events: none; }
        .content-preview-overlay.cv-mode { background: #000; pointer-events: auto; }
        .preview-window { background: rgba(40, 40, 40, 0.95); border-radius: 12px; box-shadow: 0 30px 90px rgba(0, 0, 0, 0.8); width: 700px; height: 600px; position: absolute; left: 50%; top: calc(50% + 12px); transform: translate(-50%, -50%); display: flex; overflow: hidden; }
        .preview-window.dragging, .preview-window.dragging * { user-select: none; -webkit-user-select: none; }
        .preview-sidebar { width: 180px; background: rgba(30, 30, 30, 0.98); border-right: 1px solid rgba(0, 0, 0, 0.3); display: flex; flex-direction: column; }
        .preview-sidebar-header { padding: 15px; border-bottom: 1px solid rgba(0, 0, 0, 0.3); cursor: move; }
        .preview-close-btn { color: rgba(255, 255, 255, 0.6); font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px; padding: 5px; border-radius: 4px; transition: all 0.2s; }
        .preview-close-btn:hover { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.9); }
        .preview-folders { flex: 1; overflow-y: auto; padding: 10px 0; }
        .preview-folder-item { color: rgba(255, 255, 255, 0.75); font-size: 12px; padding: 6px 15px; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: background 0.2s; }
        .preview-folder-item:hover { background: rgba(255, 255, 255, 0.1); }
        .preview-folder-item.active { background: rgba(255, 255, 255, 0.15); color: rgba(255, 255, 255, 0.95); }
        .preview-folder-icon { width: 14px; height: 14px; background: white; border-radius: 2px; opacity: 0.8; }
        .preview-main { flex: 1; display: flex; flex-direction: column; }
        .preview-header { background: rgba(60, 60, 60, 0.95); padding: 12px 20px; border-bottom: 1px solid rgba(0, 0, 0, 0.3); }
        .preview-title { color: rgba(255, 255, 255, 0.9); font-size: 13px; font-weight: 500; }
        .preview-content { flex: 1; padding: 30px; overflow-y: auto; color: white; }
        .preview-file-item { padding: 10px; margin-bottom: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 6px; cursor: pointer; transition: all 0.2s; color: rgba(255, 255, 255, 0.85); font-size: 13px; }
        .preview-file-item:hover { background: rgba(255, 255, 255, 0.1); }
        .content-preview-window { background: rgba(40, 40, 40, 0.95); border-radius: 12px; box-shadow: 0 30px 90px rgba(0, 0, 0, 0.8); width: 700px; height: 600px; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: column; overflow: hidden; }
        .content-preview-window.resizing, .content-preview-window.resizing * { user-select: none; -webkit-user-select: none; }
        .content-preview-window.presentation-mode { width: 900px; height: 700px; left: 100px; }
        .content-preview-header { background: rgba(60, 60, 60, 0.95); padding: 12px 20px; display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255, 255, 255, 0.1); cursor: move; }
        .content-preview-title { color: rgba(255, 255, 255, 0.9); font-size: 13px; font-weight: 500; }
        .content-preview-close { color: rgba(255, 255, 255, 0.6); font-size: 20px; cursor: pointer; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s; }
        .content-preview-close:hover { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.9); }
        .content-preview-body { flex: 1; padding: 30px; overflow-y: auto; color: white; }
        .content-preview-body.cv-display { display: flex; justify-content: center; padding: 60px 20px; }
        .content-preview-body.cv-display > div { max-width: 800px; width: 100%; }
        .content-preview-body h1 { font-size: 28px; margin-bottom: 16px; font-weight: 300; }
        .content-preview-body h2 { font-size: 22px; margin: 24px 0 12px; font-weight: 300; }
        .content-preview-body h3 { font-size: 18px; margin: 20px 0 10px; font-weight: 400; }
        .content-preview-body p { font-size: 14px; line-height: 2; margin-bottom: 14px; }
        .content-preview-body img { max-width: 100%; height: auto; display: block; margin: 20px 0; border-radius: 4px; }
        .loading { color: rgba(255, 255, 255, 0.5); text-align: center; padding: 30px; }
        .resize-handle { position: absolute; background: transparent; }
        .resize-handle.corner-se { width: 20px; height: 20px; bottom: 0; right: 0; cursor: nwse-resize; }
        .resize-handle.edge-e { width: 5px; height: 100%; top: 0; right: 0; cursor: ew-resize; }
        .resize-handle.edge-s { width: 100%; height: 5px; bottom: 0; left: 0; cursor: ns-resize; }
        .presentation-controls { position: absolute; top: 50%; left: 0; right: 0; display: flex; justify-content: space-between; padding: 0 20px; pointer-events: none; z-index: 10; transform: translateY(-50%); }
        .presentation-arrow { width: 50px; height: 50px; background: rgba(255, 255, 255, 0.15); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: rgba(255, 255, 255, 0.7); cursor: pointer; pointer-events: auto; transition: all 0.2s; }
        .presentation-arrow:hover { background: rgba(255, 255, 255, 0.25); color: rgba(255, 255, 255, 0.9); }
        .presentation-arrow.disabled { opacity: 0.3; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="menu-bar">
        <div class="menu-bar-left">
            <div class="menu-item" onclick="openCVFile()">k - 1</div>
            <div class="menu-item word-change" onclick="sortFolders('n')">nx</div>
            <div class="menu-item word-change" onclick="sortFolders('t')">tx</div>
            <div class="menu-item word-change" onclick="sortFolders('p')">p</div>
            <div class="menu-item word-change" onclick="sortFolders('q')">q</div>
        </div>
        <div class="menu-bar-right"><span>thu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11:55 pm</span></div>
    </div>
    <div class="desktop" id="desktop"></div>
    <div class="preview-overlay" id="previewOverlay">
        <div class="preview-window">
            <div class="preview-sidebar">
                <div class="preview-sidebar-header"><div class="preview-close-btn" onclick="closePreview()">← Close</div></div>
                <div class="preview-folders" id="previewFolderList"></div>
            </div>
            <div class="preview-main">
                <div class="preview-header"><div class="preview-title" id="previewTitle">Select a folder</div></div>
                <div class="preview-content" id="previewContent"></div>
            </div>
        </div>
    </div>
    <script>
const folderPos=[{x:170,y:520},{x:260,y:190},{x:520,y:190},{x:420,y:435},{x:520,y:680},{x:970,y:110},{x:950,y:350},{x:1230,y:350},{x:70,y:760}];
const chronoPos=[{x:100,y:400},{x:250,y:400},{x:400,y:400},{x:550,y:400},{x:700,y:400},{x:850,y:400},{x:1000,y:400},{x:1150,y:400},{x:1300,y:400}];
const geoPos=[{x:1150,y:80},{x:1280,y:160},{x:700,y:200},{x:550,y:340},{x:150,y:280},{x:200,y:420},{x:1050,y:420},{x:1200,y:650},{x:80,y:680}];
let portfolioData={};
const fn=[],d=document.getElementById('desktop');let cf=null,pm=null,ow=[],wz=3000,cpi=0,pimg=[];

async function loadPortfolioData(){
    try{
        const response=await fetch('https://raw.githubusercontent.com/ki-tya/ketadata/main/portfolioData.json');
        portfolioData=await response.json();
        fn.push(...Object.keys(portfolioData));
        createF();
    }catch(err){
        console.error('Error loading portfolio data:',err);
    }
}function getC(){const cx=window.innerWidth/2,cy=(window.innerHeight-24)/2+12,r=Math.min(cx,cy)*0.7,pos=[],step=(2*Math.PI)/fn.length;for(let i=0;i<fn.length;i++){const a=i*step-Math.PI/2;pos.push({x:cx+r*Math.cos(a)-50,y:cy+r*Math.sin(a)-50});}return pos;}function createF(){d.innerHTML='';const dr=document.createElement('div');dr.className='drive';dr.style.cssText='position:absolute;right:60px;bottom:40px';dr.innerHTML='<div class="drive-icon"></div><div class="folder-name">k-drive</div>';dr.onclick=()=>{stopPM();openKD();};d.appendChild(dr);fn.forEach((name,i)=>{const f=document.createElement('div');f.className='folder';f.style.cssText=`position:absolute;left:${folderPos[i].x}px;top:${folderPos[i].y}px`;f.innerHTML=`<div class="folder-icon"></div><div class="folder-name">${name}</div>`;f.onclick=()=>{stopPM();openF(name);};d.appendChild(f);});}function sortFolders(l){stopPM();if(l==='q'){startPM();return;}const els=document.querySelectorAll('.folder');let pos=l==='n'?chronoPos:l==='t'?getC():geoPos;els.forEach((el,i)=>{el.style.transition='all 0.5s ease';el.style.left=pos[i].x+'px';el.style.top=pos[i].y+'px';});}function startPM(){const els=document.querySelectorAll('.folder');function an(){els.forEach((el)=>{el.style.transition='all 3s ease-in-out';el.style.left=Math.random()*(window.innerWidth-150)+'px';el.style.top=Math.random()*(window.innerHeight-150)+'px';});}an();pm=setInterval(an,3000);}function stopPM(){if(pm){clearInterval(pm);pm=null;}}function openF(name){cf=name;document.getElementById('previewOverlay').classList.add('active');renderPF();loadF(name);}function closePreview(){document.getElementById('previewOverlay').classList.remove('active');cf=null;}function renderPF(){const list=document.getElementById('previewFolderList');list.innerHTML='';fn.forEach(name=>{const item=document.createElement('div');item.className='preview-folder-item';if(name===cf)item.classList.add('active');item.innerHTML=`<div class="preview-folder-icon"></div><span>${name}</span>`;item.onclick=()=>loadF(name);list.appendChild(item);});}function loadF(name){cf=name;renderPF();const title=document.getElementById('previewTitle'),content=document.getElementById('previewContent'),folder=portfolioData[name];title.textContent=name;if(!folder.files||folder.files.length===0){content.innerHTML='<div style="padding:30px;color:rgba(255,255,255,0.4);text-align:center">This folder is empty</div>';return;}let html='<div class="preview-file-list">';folder.files.forEach((file,i)=>{html+=`<div class="preview-file-item" data-folder="${name}" data-index="${i}">${file.name}</div>`;});html+='</div>';content.innerHTML=html;content.querySelectorAll('.preview-file-item').forEach(item=>{item.addEventListener('click',function(){openFile(this.getAttribute('data-folder'),parseInt(this.getAttribute('data-index')));});});}async function openFile(fname,findex){const file=portfolioData[fname].files[findex];const wid='w-'+Date.now();const wdiv=document.createElement('div');wdiv.className='content-preview-overlay active';wdiv.id=wid;wdiv.style.zIndex=++wz;wdiv.style.pointerEvents='none';const isPres=fname==='presentations';const wcls=isPres?'content-preview-window presentation-mode':'content-preview-window';wdiv.innerHTML=`<div class="${wcls}" data-wid="${wid}"><div class="content-preview-header"><div class="content-preview-title">${file.name}</div><div class="content-preview-close">×</div></div><div class="content-preview-body"><div class="loading">Loading...</div></div>${!isPres?'<div class="resize-handle edge-e"></div><div class="resize-handle edge-s"></div><div class="resize-handle corner-se"></div>':''}</div>`;document.body.appendChild(wdiv);ow.push(wid);const win=wdiv.querySelector('.content-preview-window');const body=win.querySelector('.content-preview-body');const closeBtn=win.querySelector('.content-preview-close');win.style.pointerEvents='auto';closeBtn.onclick=()=>closeW(wid);win.addEventListener('mousedown',()=>{wdiv.style.zIndex=++wz;});try{const response=await fetch(file.url);const md=await response.text();if(isPres){pimg=[];const re=/!\[([^\]]*)\]\(([^)]+)\)/g;let m;while((m=re.exec(md))!==null){pimg.push({alt:m[1],src:m[2]});}cpi=0;dispSlide(body,win);}else{body.innerHTML=parseMD(md);}}catch(err){body.innerHTML='<div style="color:rgba(255,0,0,0.7);padding:20px">Error loading file</div>';}setupDrag(win,wdiv);if(!isPres){setupResize(win);}}function dispSlide(body,wn){if(pimg.length===0){body.innerHTML='<div style="color:rgba(255,255,255,0.5);padding:30px;text-align:center;">No images found</div>';return;}const img=pimg[cpi];body.innerHTML=`<div style="display:flex;align-items:center;justify-content:center;height:100%;position:relative;"><img src="${img.src}" alt="${img.alt}" style="max-width:90%;max-height:90%;object-fit:contain;"><div class="presentation-controls"><div class="presentation-arrow ${cpi===0?'disabled':''}" onclick="prevSlide(this)">←</div><div class="presentation-arrow ${cpi===pimg.length-1?'disabled':''}" onclick="nextSlide(this)">→</div></div></div>`;}
function prevSlide(btn){if(cpi>0){cpi--;const w=btn.closest('.content-preview-window');const b=w.querySelector('.content-preview-body');dispSlide(b,w);}}
function nextSlide(btn){if(cpi<pimg.length-1){cpi++;const w=btn.closest('.content-preview-window');const b=w.querySelector('.content-preview-body');dispSlide(b,w);}}
window.prevSlide=prevSlide;
window.nextSlide=nextSlide;function closeW(wid){const wdiv=document.getElementById(wid);if(wdiv){wdiv.remove();ow=ow.filter(id=>id!==wid);}}function parseMD(md){let html='',lines=md.split('\n'),inP=false;for(let line of lines){line=line.trim();if(line===''){if(inP){html+='</p>';inP=false;}continue;}const imgMatch=line.match(/!\[([^\]]*)\]\(([^)]+)\)/);if(imgMatch){if(inP){html+='</p>';inP=false;}html+=`<img src="${imgMatch[2]}" alt="${imgMatch[1]}">`;continue;}if(line.startsWith('### ')){if(inP){html+='</p>';inP=false;}html+='<h3>'+line.substring(4)+'</h3>';}else if(line.startsWith('## ')){if(inP){html+='</p>';inP=false;}html+='<h2>'+line.substring(3)+'</h2>';}else if(line.startsWith('# ')){if(inP){html+='</p>';inP=false;}html+='<h1>'+line.substring(2)+'</h1>';}else{if(!inP){html+='<p>';inP=true;}else{html+=' ';}line=line.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>').replace(/\*(.+?)\*/g,'<em>$1</em>').replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2" target="_blank" style="color:#6ba4ff">$1</a>');html+=line;}}if(inP)html+='</p>';return html;}function closeContentPreview(){}function openCVFile(){const wid='cv-'+Date.now();const wdiv=document.createElement('div');wdiv.className='content-preview-overlay cv-mode active';wdiv.id=wid;wdiv.style.zIndex=++wz;wdiv.style.background='#000';wdiv.style.pointerEvents='none';wdiv.innerHTML=`<div class="content-preview-window" data-wid="${wid}" style="width:100vw;height:100vh;left:0;top:0;transform:none;border-radius:0;background:#000;"><div class="content-preview-header"><div class="content-preview-title">katgolubev_cv.md</div><div class="content-preview-close">×</div></div><div class="content-preview-body cv-display"><div class="loading">Loading...</div></div></div>`;document.body.appendChild(wdiv);ow.push(wid);const w=wdiv.querySelector('.content-preview-window');const b=w.querySelector('.content-preview-body');const cb=w.querySelector('.content-preview-close');w.style.pointerEvents='auto';cb.onclick=()=>closeW(wid);fetch('https://raw.githubusercontent.com/ki-tya/ketadata/main/content/katgolubev_cv.md').then(r=>r.text()).then(md=>{b.innerHTML='<div>'+parseMD(md)+'</div>';}).catch(()=>{b.innerHTML='<div style="color:rgba(255,0,0,0.7);padding:20px">Error loading CV</div>';});}function openKD(){const wid='readme-'+Date.now();const wdiv=document.createElement('div');wdiv.className='content-preview-overlay active';wdiv.id=wid;wdiv.style.zIndex=++wz;wdiv.style.pointerEvents='none';wdiv.innerHTML=`<div class="content-preview-window" data-wid="${wid}" style="width:800px;height:600px;left:300px;top:150px;background:rgba(40,40,40,0.95);"><div class="content-preview-header"><div class="content-preview-title">ketadata - README.md</div><div class="content-preview-close">×</div></div><div class="content-preview-body"><div class="loading">Loading...</div></div><div class="resize-handle edge-e"></div><div class="resize-handle edge-s"></div><div class="resize-handle corner-se"></div></div>`;document.body.appendChild(wdiv);ow.push(wid);const w=wdiv.querySelector('.content-preview-window');const b=w.querySelector('.content-preview-body');const cb=w.querySelector('.content-preview-close');w.style.pointerEvents='auto';cb.onclick=()=>closeW(wid);w.addEventListener('mousedown',()=>{wdiv.style.zIndex=++wz;});fetch('https://raw.githubusercontent.com/ki-tya/ketadata/main/README.md').then(r=>r.text()).then(md=>{b.innerHTML=parseMD(md);}).catch(()=>{b.innerHTML='<div style="color:rgba(255,0,0,0.7);padding:20px">Error loading README</div>';});setupDrag(w,wdiv);setupResize(w);}let isDrag=false,isResize=false,rType='';let sx=0,sy=0,sw=0,sh=0;let aw=null;let ao=null;function setupDrag(win,overlay){const h=win.querySelector('.content-preview-header');h.addEventListener('mousedown',(e)=>{if(e.target.classList.contains('content-preview-close'))return;isDrag=true;aw=win;ao=overlay;win.classList.add('resizing');const rect=win.getBoundingClientRect();sx=e.clientX-rect.left;sy=e.clientY-rect.top;e.preventDefault();});}function setupResize(win){win.querySelectorAll('.resize-handle').forEach(h=>{h.addEventListener('mousedown',(e)=>{e.stopPropagation();isResize=true;aw=win;win.classList.add('resizing');rType=h.classList.contains('corner-se')?'corner':h.classList.contains('edge-e')?'e':'s';sx=e.clientX;sy=e.clientY;const rect=win.getBoundingClientRect();sw=rect.width;sh=rect.height;e.preventDefault();});});}const po=document.getElementById('previewOverlay');const pw=po.querySelector('.preview-window');const ph=pw.querySelector('.preview-sidebar-header');ph.addEventListener('mousedown',(e)=>{if(e.target.classList.contains('preview-close-btn')||e.target.closest('.preview-close-btn'))return;isDrag=true;aw=pw;ao=po;pw.classList.add('dragging');const rect=pw.getBoundingClientRect();sx=e.clientX-rect.left;sy=e.clientY-rect.top;pw.style.transform='none';e.preventDefault();});document.addEventListener('mousemove',(e)=>{if(isDrag&&aw){const newL=e.clientX-sx;const newT=Math.max(24,e.clientY-sy);aw.style.left=newL+'px';aw.style.top=newT+'px';aw.style.transform='none';}if(isResize&&aw){const dx=e.clientX-sx;const dy=e.clientY-sy;if(rType==='corner'||rType==='e'){const newW=Math.max(400,sw+dx);aw.style.width=newW+'px';}if(rType==='corner'||rType==='s'){const newH=Math.max(300,sh+dy);aw.style.height=newH+'px';}}});document.addEventListener('mouseup',()=>{if(aw){aw.classList.remove('resizing');aw.classList.remove('dragging');}isDrag=false;isResize=false;aw=null;ao=null;});createF();
    </script>
</body>
</html>
