<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>KETADATA // MONTHLY CALENDAR</title>

<!-- =========================================================
 AE ▸ AESTHETIC ▸ BLACK / SHARP / DOCUMENT
========================================================= -->
<style>
:root{
  --bg:#000; --fg:#fff; --muted:#777; --line:#222;
  --invert:0;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  background:var(--bg);
  color:var(--fg);
  font-family: Arial, system-ui;
  filter: invert(var(--invert));
}

header{
  height:48px;
  border-bottom:1px solid var(--line);
  display:flex; align-items:center; justify-content:space-between;
  padding:0 10px;
}
header .left{display:flex; gap:10px; align-items:center}
header .right{display:flex; gap:8px; align-items:center}

button,input,select,textarea{
  background:#000; color:#fff; border:1px solid var(--line);
  padding:6px 8px; font-family:inherit;
}
button:hover{background:#111; cursor:pointer}

.keta-icon{
  width:14px; height:14px; border:2px solid #fff;
}
.keta-icon.filled{background:#fff}

main{
  height:calc(100% - 48px);
  display:grid;
  grid-template-columns: 1fr;
  grid-template-rows: auto 1fr;
}

.controls{
  padding:10px; border-bottom:1px solid var(--line);
  display:flex; gap:10px; flex-wrap:wrap;
}

.calendar{
  padding:10px;
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  grid-auto-rows: 120px;
  gap:6px;
}

.cell{
  border:1px solid var(--line);
  padding:6px;
  display:flex; flex-direction:column;
}
.cell header{
  height:auto; border:none; padding:0; margin-bottom:6px;
  display:flex; justify-content:space-between; align-items:center;
}
.cell .daynum{font-size:11px; color:var(--muted)}
.cell textarea{
  flex:1; resize:none; border:none;
}

.cell.week-view{
  grid-column: 1 / -1;
  grid-template-columns: repeat(7, 1fr);
}

.hidden{display:none}

/* KETA NOTE */
#ketaNote{
  position:fixed; top:70px; right:20px;
  width:260px; height:200px;
  background:#fff; color:#000;
  border:1px solid #000;
  display:none;
}
#ketaNote header{
  background:#000; color:#fff;
  padding:4px 6px; cursor:move;
  display:flex; justify-content:space-between;
}
#ketaNote textarea{
  width:100%; height:calc(100% - 28px);
  border:none; resize:none;
}
</style>
</head>

<body>

<!-- =========================================================
 WB ▸ TOP BAR ▸ GLOBAL ACCESS
========================================================= -->
<header>
  <div class="left">
    <strong>KETADATA</strong>
    <span style="color:var(--muted)">MONTHLY CALENDAR</span>
  </div>
  <div class="right">
    <div id="ketaIcon" class="keta-icon filled" title="KETA NOTE"></div>
    <button id="toggleView">MONTH / WEEK</button>
  </div>
</header>

<main>

<!-- =========================================================
 EE ▸ INPUT CONTROLS
========================================================= -->
<div class="controls">
  <label>Month
    <input id="monthName" placeholder="e.g. March">
  </label>

  <label>Days in Month
    <input id="daysInMonth" type="number" min="28" max="31" value="30">
  </label>

  <label>Weekday of 1st
    <select id="firstWeekday">
      <option value="0">Sun</option><option value="1">Mon</option>
      <option value="2">Tue</option><option value="3">Wed</option>
      <option value="4">Thu</option><option value="5">Fri</option>
      <option value="6">Sat</option>
    </select>
  </label>

  <label>
    February?
    <select id="febMode">
      <option value="no">No</option>
      <option value="28">28</option>
      <option value="29">29 (leap)</option>
    </select>
  </label>

  <button id="build">BUILD</button>
</div>

<!-- =========================================================
 EE ▸ CALENDAR GRID
========================================================= -->
<div id="calendar" class="calendar"></div>

</main>

<!-- =========================================================
 EE ▸ KETA NOTE (MENTAL ATOM)
========================================================= -->
<div id="ketaNote">
  <header>
    <span>KETA NOTE</span>
    <button id="closeNote">×</button>
  </header>
  <textarea placeholder="system intent / constraints / notes"></textarea>
</div>

<!-- =========================================================
 EE ▸ ENGINE
========================================================= -->
<script>
/* ---------- STATE ---------- */
let isWeekView=false;

/* ---------- BUILD ---------- */
function buildCalendar(){
  const cal = document.getElementById('calendar');
  cal.innerHTML = '';

  let days = +daysInMonth.value;
  if(febMode.value!=="no") days = +febMode.value;

  const start = +firstWeekday.value;

  // padding before 1st
  for(let i=0;i<start;i++){
    const pad=document.createElement('div');
    pad.className='cell';
    cal.appendChild(pad);
  }

  for(let d=1; d<=days; d++){
    const cell=document.createElement('div');
    cell.className='cell';

    const h=document.createElement('header');
    const n=document.createElement('div');
    n.className='daynum';
    n.textContent=d;
    h.appendChild(n);

    const t=document.createElement('textarea');
    t.placeholder = monthName.value
      ? `${monthName.value} ${d}`
      : `Day ${d}`;

    cell.appendChild(h);
    cell.appendChild(t);

    cal.appendChild(cell);
  }
}

/* ---------- VIEW TOGGLE ---------- */
document.getElementById('toggleView').onclick=()=>{
  isWeekView=!isWeekView;
  document.querySelectorAll('.cell').forEach(c=>{
    c.classList.toggle('week-view', isWeekView);
  });
};

/* ---------- INVERT (SHIFT+I) ---------- */
document.addEventListener('keydown',e=>{
  if(e.shiftKey && e.key.toLowerCase()==='i'){
    const cur = getComputedStyle(document.documentElement)
      .getPropertyValue('--invert');
    document.documentElement.style.setProperty(
      '--invert', cur.trim()==='1' ? 0 : 1
    );
  }
});

/* ---------- KETA NOTE ---------- */
const note=document.getElementById('ketaNote');
const icon=document.getElementById('ketaIcon');
icon.onclick=()=>{
  const open = note.style.display==='block';
  note.style.display = open?'none':'block';
  icon.classList.toggle('filled', open);
};
closeNote.onclick=icon.onclick;

/* ---------- INIT ---------- */
build.onclick=buildCalendar;
buildCalendar();
</script>

</body>
</html>
